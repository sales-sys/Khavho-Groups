<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khavho Groups - Premier Supplier for Industry & Construction</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Swiper.js for carousels -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <!-- noUiSlider for price range -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.5.1/nouislider.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.5.1/nouislider.min.js"></script>

    <style>
        :root {
            --color-primary: #212121;
            --color-accent: #F37021;
            --color-secondary: #6E7A8A;
            --color-background: #F7F9FB;
            --color-light-gray: #E0E0E0;
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
            color: var(--color-primary);
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
        }
        .bg-primary { background-color: var(--color-primary); }
        .bg-accent { background-color: var(--color-accent); }
        .text-accent { color: var(--color-accent); }
        .border-accent { border-color: var(--color-accent); }
        .ring-accent { --tw-ring-color: var(--color-accent); }
        .text-secondary { color: var(--color-secondary); }
        .hero-bg {
             background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://placehold.co/1920x1080/4A5568/FFFFFF?text=Khavho+Warehouse');
             background-size: cover;
             background-position: center;
             background-attachment: fixed;
        }
        .category-card, .product-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .category-card:hover, .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        /* Swiper Carousel Styles */
        .swiper-button-next, .swiper-button-prev {
            color: var(--color-accent);
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 1.25rem;
            font-weight: 700;
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* Search Modal */
        #search-modal {
            transition: opacity 0.3s ease-in-out;
        }
        .form-input {
            @apply mt-1 block w-full rounded-md border-gray-400 bg-gray-50 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50;
        }
        .form-label {
            @apply block text-sm font-medium text-gray-700;
        }
        /* Custom Styles for Price Slider */
        .noUi-connect {
            background: var(--color-accent);
        }
        .noUi-handle {
            border: 1px solid var(--color-accent);
            border-radius: 50%;
            box-shadow: none;
            background: #fff;
        }
        .noUi-handle:focus {
            outline: none;
        }
        /* FAQ Accordion */
        .faq-question.active + .faq-answer {
            max-height: 500px;
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
        }
    </style>
</head>
<body class="antialiased">

    <!-- ============================================================================== -->
    <!--                                  HEADER                                        -->
    <!-- ============================================================================== -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <!-- Logo -->
            <a href="#" class="flex items-center space-x-2 main-nav-link" data-page="home">
                <div class="flex items-center">
                    <span class="text-3xl font-bold text-primary">K</span>
                    <span class="text-3xl font-bold text-accent -ml-1 transform -skew-x-12">G</span>
                </div>
                <span class="text-xl font-semibold text-primary hidden sm:inline">Khavho Groups</span>
            </a>

            <!-- Desktop Navigation Links -->
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" class="text-primary hover:text-accent transition duration-300 main-nav-link" data-page="home">Home</a>
                <a href="#" class="text-primary hover:text-accent transition duration-300 main-nav-link" data-page="products">Products</a>
                <a href="#" class="text-primary hover:text-accent transition duration-300 main-nav-link" data-page="companies">Our Companies</a>
                <a href="#" class="text-primary hover:text-accent transition duration-300 main-nav-link" data-page="about">About Us</a>
                <a href="#" class="text-primary hover:text-accent transition duration-300 main-nav-link" data-page="contact">Contact Us</a>
            </div>

            <!-- Header Icons & Actions -->
            <div class="flex items-center space-x-4">
                <button id="search-button" class="text-primary hover:text-accent transition duration-300"><i data-lucide="search"></i></button>
                <a href="#" class="text-primary hover:text-accent transition duration-300 relative main-nav-link" data-page="cart">
                    <i data-lucide="shopping-cart"></i>
                    <span id="cart-item-count" class="absolute -top-2 -right-2 bg-accent text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </a>
                
                <div id="auth-container">
                    <!-- This will be dynamically filled by JS -->
                </div>

                <a href="#" class="hidden lg:inline-block bg-accent text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-opacity-90 transition duration-300 main-nav-link" data-page="finance">
                    Apply for Finance
                </a>
                <button id="mobile-menu-button" class="md:hidden text-primary">
                    <i data-lucide="menu"></i>
                </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pt-2 pb-4 space-y-2 bg-white border-t border-gray-200">
            <a href="#" class="block text-primary hover:text-accent transition duration-300 main-nav-link" data-page="home">Home</a>
            <a href="#" class="block text-primary hover:text-accent transition duration-300 main-nav-link" data-page="products">Products</a>
            <a href="#" class="block text-primary hover:text-accent transition duration-300 main-nav-link" data-page="companies">Our Companies</a>
            <a href="#" class="block text-primary hover:text-accent transition duration-300 main-nav-link" data-page="about">About Us</a>
            <a href="#" class="block text-primary hover:text-accent transition duration-300 main-nav-link" data-page="contact">Contact Us</a>
             <a href="#" class="block bg-accent text-white text-center px-4 py-2 mt-2 rounded-lg text-sm font-medium hover:bg-opacity-90 transition duration-300 main-nav-link" data-page="finance">
                    Apply for Finance
                </a>
        </div>
    </header>

    <main id="main-content">
        <!-- ============================================================================== -->
        <!--                                  HOME PAGE                                     -->
        <!-- ============================================================================== -->
        <section id="page-home" class="page active">
            <!-- Section 1: Hero Section -->
            <section class="hero-bg text-white">
                <div class="container mx-auto px-6 py-32 text-center">
                    <h1 class="text-4xl md:text-6xl font-bold leading-tight mb-4">The Premier Supplier for Industry & Construction.</h1>
                    <p class="text-lg md:text-xl text-gray-200 mb-8 max-w-3xl mx-auto">Your trusted source for tools, hardware, electrical, and building materials.</p>
                     <a href="#" data-page="products" class="main-nav-link mt-8 inline-block bg-accent text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-opacity-90 transition duration-300">
                        Shop All Products
                    </a>
                </div>
            </section>

            <!-- Section 2: Key Categories -->
            <section class="py-16 sm:py-24 bg-white">
                <div class="container mx-auto px-6 text-center">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Shop Our Top Categories</h2>
                    <p class="text-secondary mb-12 max-w-2xl mx-auto">From heavy-duty industrial tools to essential building supplies, we have everything your project needs.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                        <!-- Category Cards -->
                        <div class="category-card bg-gray-50 rounded-lg overflow-hidden text-left">
                            <img src="https://placehold.co/600x400/E0E0E0/212121?text=Industrial+Tools" alt="Industrial Tools" class="w-full h-48 object-cover">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">Industrial Tools</h3>
                                <p class="text-secondary mb-4 text-sm">High-performance tools for every professional application.</p>
                                <a href="#" class="font-medium text-accent hover:underline main-nav-link" data-page="products">Shop Now <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                            </div>
                        </div>
                        <div class="category-card bg-gray-50 rounded-lg overflow-hidden text-left">
                            <img src="https://placehold.co/600x400/E0E0E0/212121?text=Hardware" alt="Hardware" class="w-full h-48 object-cover">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">Hardware</h3>
                                <p class="text-secondary mb-4 text-sm">A comprehensive range of fasteners, fixtures, and fittings.</p>
                                <a href="#" class="font-medium text-accent hover:underline main-nav-link" data-page="products">Shop Now <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                            </div>
                        </div>
                        <div class="category-card bg-gray-50 rounded-lg overflow-hidden text-left">
                            <img src="https://placehold.co/600x400/E0E0E0/212121?text=Electrical" alt="Electrical Components" class="w-full h-48 object-cover">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">Electrical Components</h3>
                                <p class="text-secondary mb-4 text-sm">Certified wiring, lighting, and electrical supplies.</p>
                                <a href="#" class="font-medium text-accent hover:underline main-nav-link" data-page="products">Shop Now <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                            </div>
                        </div>
                        <div class="category-card bg-gray-50 rounded-lg overflow-hidden text-left">
                            <img src="https://placehold.co/600x400/E0E0E0/212121?text=Building+Materials" alt="Building Materials" class="w-full h-48 object-cover">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">Building Materials</h3>
                                <p class="text-secondary mb-4 text-sm">Quality materials for construction, from foundation to finish.</p>
                                <a href="#" class="font-medium text-accent hover:underline main-nav-link" data-page="products">Shop Now <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                            </div>
                        </div>
                        <div class="category-card bg-gray-50 rounded-lg overflow-hidden text-left">
                            <img src="https://placehold.co/600x400/E0E0E0/212121?text=Safety+Equipment" alt="Safety Equipment" class="w-full h-48 object-cover">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">Safety Equipment</h3>
                                <p class="text-secondary mb-4 text-sm">Protect your team with our range of safety gear.</p>
                                <a href="#" class="font-medium text-accent hover:underline main-nav-link" data-page="products">Shop Now <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                            </div>
                        </div>
                        <div class="category-card bg-gray-50 rounded-lg overflow-hidden text-left">
                            <img src="https://placehold.co/600x400/E0E0E0/212121?text=Plumbing" alt="Plumbing Supplies" class="w-full h-48 object-cover">
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">Plumbing Supplies</h3>
                                <p class="text-secondary mb-4 text-sm">Durable pipes, fittings, and fixtures for all systems.</p>
                                <a href="#" class="font-medium text-accent hover:underline main-nav-link" data-page="products">Shop Now <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Section 3: Value Proposition -->
            <section class="py-16 sm:py-24">
                 <div class="container mx-auto px-6">
                    <div class="text-center">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4">Why Choose Khavho Groups?</h2>
                        <p class="text-secondary mb-12 max-w-2xl mx-auto">We are more than a supplier; we are a partner in your success, dedicated to quality, reliability, and innovative solutions.</p>
                    </div>
                    <div class="grid md:grid-cols-3 gap-8 text-center">
                        <div class="bg-white p-8 rounded-lg shadow-md">
                            <div class="bg-accent text-white rounded-full h-16 w-16 mx-auto flex items-center justify-center mb-6">
                                <i data-lucide="shield-check" class="h-8 w-8"></i>
                            </div>
                            <h3 class="text-xl font-semibold mb-2">Verified Quality</h3>
                            <p class="text-secondary">Every product is sourced from trusted brands and meets rigorous industry standards.</p>
                        </div>
                        <div class="bg-white p-8 rounded-lg shadow-md">
                            <div class="bg-accent text-white rounded-full h-16 w-16 mx-auto flex items-center justify-center mb-6">
                                <i data-lucide="truck" class="h-8 w-8"></i>
                            </div>
                            <h3 class="text-xl font-semibold mb-2">Reliable Delivery</h3>
                            <p class="text-secondary">Fast and dependable shipping across the nation to keep your project on schedule.</p>
                        </div>
                        <div class="bg-white p-8 rounded-lg shadow-md">
                            <div class="bg-accent text-white rounded-full h-16 w-16 mx-auto flex items-center justify-center mb-6">
                                <i data-lucide="file-check-2" class="h-8 w-8"></i>
                            </div>
                            <h3 class="text-xl font-semibold mb-2">Instant Financing</h3>
                            <p class="text-secondary">Apply for credit in minutes and get an immediate decision to fund your procurement needs.</p>
                        </div>
                    </div>
                    <div class="text-center mt-12">
                        <a href="#" class="bg-accent text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-opacity-90 transition duration-300 main-nav-link" data-page="finance">
                            Learn About Financing
                        </a>
                    </div>
                 </div>
            </section>

            <!-- Section 4: Featured Products -->
            <section class="py-16 sm:py-24 bg-white">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Top Selling Products</h2>
                    <div class="swiper-container featured-products-slider relative">
                        <div id="featured-products-wrapper" class="swiper-wrapper">
                            <!-- Products will be injected here by JavaScript -->
                        </div>
                        <!-- Add Pagination -->
                        <div class="swiper-pagination"></div>
                    </div>
                     <!-- Navigation buttons -->
                    <div class="swiper-button-prev featured-prev"></div>
                    <div class="swiper-button-next featured-next"></div>
                </div>
            </section>
            
            <!-- Section 5: Featured Brands -->
            <section class="py-16 sm:py-24">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Proudly Stocking Leading Brands</h2>
                    <div class="swiper-container brands-slider">
                        <div class="swiper-wrapper items-center">
                            <!-- Brand Logos -->
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=DEWALT" alt="DEWALT" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=MAKITA" alt="MAKITA" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=BOSCH" alt="BOSCH" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=3M" alt="3M" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=PPC+CEMENT" alt="PPC CEMENT" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=STANLEY" alt="STANLEY" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                            <div class="swiper-slide text-center"><img src="https://placehold.co/200x100/CCCCCC/6E7A8A?text=INGCO" alt="INGCO" class="mx-auto grayscale hover:grayscale-0 transition duration-300"></div>
                        </div>
                    </div>
                </div>
            </section>
        </section>

        <!-- ============================================================================== -->
        <!--                           ALL OTHER PAGES CONTAINER                            -->
        <!-- ============================================================================== -->
        <div id="page-container">
            <!-- Pages will be injected here by JavaScript -->
        </div>
    </main>

    <!-- ============================================================================== -->
    <!--                                  FOOTER                                        -->
    <!-- ============================================================================== -->
    <footer class="bg-primary text-white">
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h4 class="text-lg font-semibold mb-4">Khavho Groups</h4>
                    <p class="text-gray-400 text-sm">Your premier partner for industrial and construction supplies, offering quality products and reliable service.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white main-nav-link" data-page="products">Products</a></li>
                         <li><a href="#" class="text-gray-400 hover:text-white main-nav-link" data-page="companies">Our Companies</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white main-nav-link" data-page="about">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white main-nav-link" data-page="contact">Contact Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white main-nav-link" data-page="faq">FAQ</a></li>
                    </ul>
                </div>
                 <div>
                    <h4 class="text-lg font-semibold mb-4">Legal</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white">Terms of Service</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Shipping Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Contact Us</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li class="flex items-start"><i data-lucide="map-pin" class="w-4 h-4 mr-2 mt-1 flex-shrink-0"></i><span>123 Industrial Way, Johannesburg, SA</span></li>
                        <li class="flex items-center"><i data-lucide="phone" class="w-4 h-4 mr-2 flex-shrink-0"></i><span>+27 10 123 4567</span></li>
                        <li class="flex items-center"><i data-lucide="mail" class="w-4 h-4 mr-2 flex-shrink-0"></i><span>sales@khavhogroups.co.za</span></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-700 text-center text-sm text-gray-500">
                <p>&copy; <span id="currentYear"></span> Khavho Groups. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- ============================================================================== -->
    <!--                               SEARCH MODAL                                     -->
    <!-- ============================================================================== -->
    <div id="search-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-start justify-center p-4 pt-20 hidden opacity-0">
        <div class="bg-white w-full max-w-2xl rounded-lg shadow-xl" id="search-modal-content">
            <div class="relative">
                <input type="text" id="search-input" placeholder="Search for products by name, brand, or category..." class="w-full p-4 text-lg border-2 border-transparent focus:outline-none focus:ring-2 ring-accent rounded-t-lg">
                <button id="close-search-modal" class="absolute top-1/2 right-4 -translate-y-1/2 text-gray-500 hover:text-primary"><i data-lucide="x" class="w-8 h-8"></i></button>
            </div>
            <div id="search-results-container" class="p-6 max-h-[60vh] overflow-y-auto">
                <p class="text-secondary text-sm">Start typing to see product suggestions.</p>
                <!-- Search results would appear here -->
            </div>
        </div>
    </div>


    <!-- ============================================================================== -->
    <!--                                  JAVASCRIPT                                    -->
    <!-- ============================================================================== -->
    <script type="module">
        // Firebase Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            onAuthStateChanged, 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            signOut,
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            getDoc 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";


        document.addEventListener('DOMContentLoaded', function () {

            // ========================================================== //
            //                  FIREBASE INITIALIZATION                   //
            // ========================================================== //
            
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            const db = getFirestore(app);

            // ========================================================== //
            //                  DATABASE & STATE MANAGEMENT                 //
            // ========================================================== //
            
            let currentUser = null; // Will hold user object from Firebase
            let shoppingCart = []; // Local cart for anonymous users or before DB fetch

            const productDatabase = [
                // --- Industrial Tools (Total: 25) ---
                { id: 1, name: '20V MAX Cordless Drill Driver Kit', brand: 'DEWALT', price: 2499.00, image: 'Drill-Driver-Kit', category: 'Industrial Tools', rating: 4.5, reviews: 128, description: 'High-performance drill driver with two batteries, charger, and carrying case. Perfect for a wide range of applications.', specs: { Voltage: '20V', ChuckSize: '1/2-Inch', BatteryType: 'Lithium-Ion' } },
                { id: 2, name: '18V LXT Angle Grinder', brand: 'MAKITA', price: 3150.00, image: 'Angle-Grinder', category: 'Industrial Tools', rating: 4.8, reviews: 97, description: 'Powerful and compact angle grinder with brushless motor for longer run time and tool life.', specs: { Voltage: '18V', WheelDiameter: '4-1/2-Inch', NoLoadSpeed: '8,500 RPM' } },
                { id: 3, name: 'Professional Laser Measure GLM 50 C', brand: 'BOSCH', price: 1899.00, image: 'Laser-Measure', category: 'Industrial Tools', rating: 5.0, reviews: 210, description: 'Measures distances up to 50m with an accuracy of ±1.5mm. Features multiple measurement modes and Bluetooth connectivity.', specs: { Range: '50m', Accuracy: '±1.5mm', Bluetooth: 'Yes' } },
                { id: 6, name: 'FatMax Tape Measure - 8m', brand: 'STANLEY', price: 350.00, image: 'Tape-Measure', category: 'Industrial Tools', rating: 4.7, reviews: 189, description: 'Durable and reliable 8-meter tape measure with BladeArmor coating for maximum durability.', specs: { Length: '8m / 26ft', BladeWidth: '32mm', Coating: 'BladeArmor' } },
                { id: 7, name: 'Industrial Pliers Set - 3 Piece', brand: 'INGCO', price: 450.00, image: 'Pliers-Set', category: 'Industrial Tools', rating: 4.4, reviews: 76, description: 'Includes combination pliers, long nose pliers, and diagonal cutting pliers. Made from Cr-V steel.', specs: { Material: 'Chrome-Vanadium Steel', Pieces: '3', Grip: 'Comfort Grip' } },
                { id: 11, name: 'Portable Arc Welder - 200A', brand: 'GENTECH', price: 3800.00, image: 'Arc-Welder', category: 'Industrial Tools', rating: 4.6, reviews: 64, description: 'IGBT inverter technology provides stable arc and reliable performance. Suitable for MMA welding.', specs: { Current: '20-200A', DutyCycle: '60%', ElectrodeSize: '1.6-4.0mm' } },
                { id: 12, name: '10-Inch Compound Miter Saw', brand: 'RYOBI', price: 4200.00, image: 'Miter-Saw', category: 'Industrial Tools', rating: 4.5, reviews: 112, description: 'Features a 15 Amp motor to make difficult cuts with ease. Exactline adjustable laser alignment system.', specs: { BladeSize: '10-Inch', Motor: '15 Amp', LaserGuide: 'Yes' } },
                { id: 13, name: 'Heavy-Duty Bench Vise - 6 Inch', brand: 'YATO', price: 1500.00, image: 'Bench-Vise', category: 'Industrial Tools', rating: 4.8, reviews: 99, description: 'Cast iron construction with a swivel base for versatile work positioning. Replaceable serrated steel jaws.', specs: { JawWidth: '6-Inch', Material: 'Cast Iron', Base: '360° Swivel' } },
                { id: 14, name: 'Digital Multimeter CAT III', brand: 'FLUKE', price: 2900.00, image: 'Multimeter', category: 'Industrial Tools', rating: 4.9, reviews: 150, description: 'Provides accurate measurements for troubleshooting electrical problems. Rated for CAT III 600V safety.', specs: { SafetyRating: 'CAT III 600V', Display: '6000 Count LCD', Functions: 'AC/DC Voltage, Current, Resistance, Capacitance' } },
                { id: 15, name: '2-Ton Hydraulic Trolley Jack', brand: 'MOTOMETER', price: 1800.00, image: 'Trolley-Jack', category: 'Industrial Tools', rating: 4.3, reviews: 81, description: 'Low profile design for easy access under vehicles. Heavy-duty steel construction for durability.', specs: { Capacity: '2 Ton', LiftRange: '89mm - 359mm', Material: 'Steel' } },
                { id: 36, name: 'Reciprocating Saw - 900W', brand: 'DEWALT', price: 2800.00, image: 'Recip-Saw', category: 'Industrial Tools', rating: 4.7, reviews: 88, description: 'Powerful saw for demolition and rough cutting of wood and metal.', specs: { Power: '900W', SPM: '0-3200', StrokeLength: '28mm' } },
                { id: 37, name: 'Impact Wrench 1/2-Inch Kit', brand: 'MAKITA', price: 5500.00, image: 'Impact-Wrench', category: 'Industrial Tools', rating: 4.9, reviews: 110, description: 'High-torque impact wrench for heavy-duty fastening applications.', specs: { Drive: '1/2-Inch', Torque: '1000 Nm', Voltage: '18V' } },
                { id: 38, name: 'Rotary Hammer Drill SDS-Plus', brand: 'BOSCH', price: 3500.00, image: 'Rotary-Hammer', category: 'Industrial Tools', rating: 4.8, reviews: 132, description: '3-mode rotary hammer for drilling, hammer drilling, and chiseling in concrete.', specs: { Chuck: 'SDS-Plus', ImpactEnergy: '2.7 J', Power: '800W' } },
                { id: 53, name: 'Jigsaw with Variable Speed - 650W', brand: 'INGCO', price: 950.00, image: 'Jigsaw', category: 'Industrial Tools', rating: 4.4, reviews: 105, description: 'Versatile jigsaw for straight and curved cuts in wood, metal, and plastic.', specs: { Power: '650W', Speed: '800-3000 SPM', BevelCut: '0-45°' } },
                { id: 54, name: 'Orbital Sander - 200W', brand: 'RYOBI', price: 700.00, image: 'Orbital-Sander', category: 'Industrial Tools', rating: 4.5, reviews: 120, description: '1/3 sheet orbital sander for a fine, swirl-free finish on wood surfaces.', specs: { Power: '200W', OrbitsPerMin: '12,000', PaperSize: '1/3 Sheet' } },
                { id: 55, name: 'Socket Set 1/2-Inch Drive - 24 Piece', brand: 'YATO', price: 1200.00, image: 'Socket-Set', category: 'Industrial Tools', rating: 4.9, reviews: 180, description: 'Comprehensive socket set made from durable Cr-V steel in a sturdy carry case.', specs: { Drive: '1/2-Inch', Pieces: '24', Material: 'Cr-V Steel' } },
                { id: 67, name: 'Heat Gun - 2000W', brand: 'BOSCH', price: 900.00, image: 'Heat-Gun', category: 'Industrial Tools', rating: 4.7, reviews: 130, description: 'Versatile tool for stripping paint, shrinking tubing, and thawing pipes. Two temperature settings.', specs: { Power: '2000W', TempRange: '350°C - 550°C', Airflow: '300/500 L/min' } },
                { id: 68, name: 'Portable Air Compressor - 50L', brand: 'GENTECH', price: 2500.00, image: 'Air-Compressor', category: 'Industrial Tools', rating: 4.6, reviews: 95, description: 'Direct drive compressor for powering pneumatic tools, spray painting, and inflation.', specs: { Tank: '50 Litre', Power: '2.5 HP', MaxPressure: '8 Bar' } },
                { id: 82, name: 'Belt Sander - 720W', brand: 'MAKITA', price: 3200.00, image: 'Belt-Sander', category: 'Industrial Tools', rating: 4.8, reviews: 115, description: 'For rapid material removal on large, flat surfaces. Low profile design for balance.', specs: { Power: '720W', BeltSize: '76x533mm', Speed: '250 m/min' } },
                { id: 83, name: 'Chain Hoist - 1 Ton', brand: 'YATO', price: 1800.00, image: 'Chain-Hoist', category: 'Industrial Tools', rating: 4.9, reviews: 90, description: 'Manual chain block for lifting heavy loads in workshops and garages.', specs: { Capacity: '1 Ton', LiftHeight: '3m', Chain: 'Grade 80' } },
                { id: 94, name: 'SDS-Plus Chisel Set - 3 Piece', brand: 'BOSCH', price: 400.00, image: 'Chisel-Set', category: 'Industrial Tools', rating: 4.8, reviews: 110, description: 'Includes pointed chisel, flat chisel, and tile chisel for rotary hammers.', specs: { Shank: 'SDS-Plus', Pieces: '3', Use: 'Demolition, Tiling' } },
                { id: 101, name: 'Planer - 82mm, 650W', brand: 'RYOBI', price: 1100.00, image: 'Planer', category: 'Industrial Tools', rating: 4.6, reviews: 92, description: 'Powerful electric planer for smoothing and shaping wood surfaces.', specs: { Power: '650W', PlaningWidth: '82mm', PlaningDepth: '2mm' } },
                { id: 102, name: 'Industrial Wet & Dry Vacuum - 30L', brand: 'KARCHER', price: 2800.00, image: 'Wet-Dry-Vac', category: 'Industrial Tools', rating: 4.9, reviews: 155, description: 'Robust and versatile vacuum cleaner for coarse dirt and liquids in workshops and construction sites.', specs: { Capacity: '30L', Power: '1380W', Function: 'Wet & Dry' } },
                { id: 103, name: 'Drill Press - 5 Speed', brand: 'INGCO', price: 2200.00, image: 'Drill-Press', category: 'Industrial Tools', rating: 4.5, reviews: 78, description: 'Benchtop drill press for accurate drilling in wood, metal, and plastic.', specs: { Motor: '550W', Speeds: '5', ChuckCapacity: '16mm' } },
                { id: 104, name: 'Circular Saw - 185mm', brand: 'MAKITA', price: 2400.00, image: 'Circular-Saw', category: 'Industrial Tools', rating: 4.8, reviews: 140, description: 'High-performance circular saw for fast and accurate cutting of timber.', specs: { BladeDiameter: '185mm', Power: '1800W', NoLoadSpeed: '5,800 RPM' } },
                
                // --- Safety Equipment (Total: 15) ---
                { id: 4, name: 'Aura Particulate Respirator 9210+', brand: '3M', price: 75.00, image: 'Respirator-Mask', category: 'Safety Equipment', rating: 4.2, reviews: 450, description: 'NIOSH approved for at least 95 percent filtration efficiency against certain non-oil based particles.', specs: { Standard: 'N95', Style: 'Flat Fold', Valve: 'No' } },
                { id: 16, name: 'Hard Hat with Ratchet Suspension', brand: 'MSA', price: 280.00, image: 'Hard-Hat', category: 'Safety Equipment', rating: 4.9, reviews: 205, description: 'Lightweight and durable V-Gard hard hat. Fas-Trac III ratchet suspension for a comfortable fit.', specs: { Material: 'HDPE', Suspension: '4-point Ratchet', Class: 'Type 1, Class E' } },
                { id: 17, name: 'High-Visibility Safety Vest - Orange', brand: 'JAVLIN', price: 120.00, image: 'Safety-Vest', category: 'Safety Equipment', rating: 4.7, reviews: 310, description: 'ANSI/ISEA 107 Class 2 compliant vest with reflective tape for enhanced visibility.', specs: { Color: 'Fluorescent Orange', Class: 'Class 2', Material: 'Polyester Mesh' } },
                { id: 18, name: 'Leather Work Gloves - Lined', brand: 'BATA', price: 150.00, image: 'Work-Gloves', category: 'Safety Equipment', rating: 4.5, reviews: 180, description: 'Durable cowhide leather gloves for heavy-duty work. Keystone thumb for superior flexibility.', specs: { Material: 'Cowhide Leather', Size: 'Large', Cuff: 'Elastic' } },
                { id: 19, name: 'Anti-Fog Safety Goggles', brand: 'UVEX', price: 220.00, image: 'Safety-Goggles', category: 'Safety Equipment', rating: 4.8, reviews: 130, description: 'Protects against impact, dust, and chemical splash. Uvextreme anti-fog coating.', specs: { Lens: 'Clear Polycarbonate', Coating: 'Anti-Fog, Anti-Scratch', Ventilation: 'Indirect' } },
                { id: 39, name: 'Fall Arrest Harness - Full Body', brand: 'KARAM', price: 1200.00, image: 'Harness', category: 'Safety Equipment', rating: 4.9, reviews: 95, description: 'Fully adjustable harness for fall protection when working at height.', specs: { Points: 'Dorsal & Sternal D-rings', Standard: 'EN 361', Size: 'Universal' } },
                { id: 40, name: 'Steel Toe Cap Safety Boots', brand: 'BATA', price: 850.00, image: 'Safety-Boots', category: 'Safety Equipment', rating: 4.6, reviews: 240, description: 'Durable leather boots with steel toe cap and anti-slip sole.', specs: { ToeCap: '200J Steel', Sole: 'Dual Density PU', Standard: 'SANS 20345' } },
                { id: 52, name: 'Ear Muffs - High Attenuation', brand: '3M', price: 350.00, image: 'Ear-Muffs', category: 'Safety Equipment', rating: 4.8, reviews: 160, description: 'Peltor X-Series earmuffs for protection against high-level industrial noise.', specs: { NRR: '31 dB', Type: 'Over-the-Head', Series: 'Peltor X5A' } },
                { id: 56, name: 'Fire Extinguisher - 4.5kg DCP', brand: 'FIREMATE', price: 650.00, image: 'Fire-Extinguisher', category: 'Safety Equipment', rating: 5.0, reviews: 150, description: 'Dry chemical powder extinguisher suitable for Class A, B, and C fires.', specs: { Size: '4.5kg', Type: 'DCP', Rating: '4A, 21B' } },
                { id: 57, name: 'First Aid Kit - Regulation 3', brand: 'LIFELINE', price: 400.00, image: 'First-Aid-Kit', category: 'Safety Equipment', rating: 4.9, reviews: 200, description: 'Complies with the OHS Act Regulation 3 for workplace first aid.', specs: { Compliance: 'OHS Act Reg 3', Container: 'Metal Box', Users: 'Up to 15' } },
                { id: 69, name: 'Welding Helmet - Auto Darkening', brand: 'GENTECH', price: 750.00, image: 'Welding-Helmet', category: 'Safety Equipment', rating: 4.8, reviews: 140, description: 'Protects eyes and face from sparks and UV/IR radiation. Automatically darkens when arc is struck.', specs: { ViewingArea: '92x42mm', ShadeRange: 'DIN 9-13', Power: 'Solar + Battery' } },
                { id: 70, name: 'Safety Sign - Fire Extinguisher', brand: 'SAFELOC', price: 80.00, image: 'Safety-Sign', category: 'Safety Equipment', rating: 4.9, reviews: 300, description: 'Photoluminescent sign to clearly identify the location of fire extinguishers.', specs: { Material: 'ABS Plastic', Size: '190x190mm', Feature: 'Glow-in-the-dark' } },
                { id: 84, name: 'Chemical Splash Goggles', brand: 'UVEX', price: 250.00, image: 'Chemical-Goggles', category: 'Safety Equipment', rating: 4.7, reviews: 120, description: 'Provides protection against chemical splashes and impacts. Fits over prescription glasses.', specs: { Type: 'Chemical Splash', Coating: 'Anti-Fog', Ventilation: 'Indirect' } },
                { id: 85, name: 'Welding Gloves - Leather', brand: 'AFROX', price: 200.00, image: 'Welding-Gloves', category: 'Safety Equipment', rating: 4.8, reviews: 190, description: 'Heavy-duty leather gloves with Kevlar stitching for welding applications.', specs: { Material: 'Cowhide Leather', Stitching: 'Kevlar', Length: 'Long Cuff' } },
                { id: 95, name: 'Safety Cones 750mm - Pack of 2', brand: 'SAFELOC', price: 300.00, image: 'Safety-Cones', category: 'Safety Equipment', rating: 4.9, reviews: 160, description: 'High-visibility traffic cones with reflective sleeves for day and night use.', specs: { Height: '750mm', Material: 'PVC', Feature: 'Reflective Sleeve' } },

                // --- Building Materials (Total: 20) ---
                { id: 5, name: 'Surebuild 42.5N Cement - 50kg', brand: 'PPC CEMENT', price: 110.00, image: 'Cement-Bag', category: 'Building Materials', rating: 4.9, reviews: 305, description: 'High-quality general purpose cement ideal for concrete, mortar, plaster and screed applications.', specs: { Strength: '42.5N', Weight: '50kg', Type: 'General Purpose' } },
                { id: 20, name: 'Standard Clay Stock Bricks (per 1000)', brand: 'COROBRIK', price: 2800.00, image: 'Bricks-Stack', category: 'Building Materials', rating: 4.8, reviews: 190, description: 'NFP (Non-Facing Plastered) bricks for general building work that is to be plastered.', specs: { Type: 'NFP Clay Stock', Quantity: '1000', Dimensions: '222x106x73mm' } },
                { id: 21, name: 'Washed River Sand (per m³)', brand: 'BUILDERS', price: 450.00, image: 'River-Sand', category: 'Building Materials', rating: 4.6, reviews: 150, description: 'Ideal for mixing with cement to make concrete, mortar, and plaster.', specs: { Type: 'Washed River Sand', Unit: 'Cubic Meter (m³)', Use: 'Concrete, Mortar' } },
                { id: 22, name: '19mm Builders Stone (per m³)', brand: 'AFRISAM', price: 500.00, image: 'Builders-Stone', category: 'Building Materials', rating: 4.7, reviews: 120, description: 'Crushed stone aggregate used for making standard to high-strength concrete mixes.', specs: { Size: '19mm', Unit: 'Cubic Meter (m³)', Use: 'Concrete Mix' } },
                { id: 23, name: 'SABS Pine Structural Timber (38x114mm x 3.6m)', brand: 'SABS', price: 180.00, image: 'Pine-Timber', category: 'Building Materials', rating: 4.5, reviews: 95, description: 'SABS graded South African pine for structural applications like roofing and framing.', specs: { Grade: 'S5', Dimensions: '38x114mm', Length: '3.6m' } },
                { id: 41, name: 'Waterproofing Membrane - 5L', brand: 'DULUX', price: 450.00, image: 'Waterproofing', category: 'Building Materials', rating: 4.7, reviews: 110, description: 'Acrylic waterproofing compound for roofs, walls, and parapets. Used with membrane.', specs: { Type: 'Acrylic', Volume: '5L', Color: 'Grey' } },
                { id: 42, name: 'IBR Roof Sheeting 0.5mm Galvanized - 3.6m', brand: 'SAFINTRA', price: 550.00, image: 'Roof-Sheeting', category: 'Building Materials', rating: 4.8, reviews: 160, description: 'Inverted Box Rib profile roofing sheet for industrial and commercial buildings.', specs: { Thickness: '0.5mm', Material: 'Galvanized Steel', Length: '3.6m' } },
                { id: 50, name: 'Ceramic Wall Tiles - White 20x30cm (1.5m²)', brand: 'TILE-AFRICA', price: 180.00, image: 'Wall-Tiles', category: 'Building Materials', rating: 4.5, reviews: 90, description: 'Gloss white ceramic tiles for bathroom and kitchen walls.', specs: { Size: '20x30cm', Finish: 'Gloss', Coverage: '1.5m²' } },
                { id: 51, name: 'Tile Adhesive - 20kg', brand: 'TAL', price: 150.00, image: 'Tile-Adhesive', category: 'Building Materials', rating: 4.9, reviews: 250, description: 'High-strength, cement-based adhesive for fixing ceramic, porcelain, and natural stone tiles.', specs: { Weight: '20kg', Type: 'Cement-based', Application: 'Wall & Floor' } },
                { id: 58, name: 'RhinoLite Plaster - 40kg', brand: 'GYPROC', price: 250.00, image: 'Plaster-Bag', category: 'Building Materials', rating: 4.9, reviews: 350, description: 'A lightweight gypsum plaster for a high-quality interior finish onto most surfaces.', specs: { Weight: '40kg', Type: 'Gypsum Finishing Plaster', Coverage: '~20m²' } },
                { id: 59, name: 'Self-Leveling Screed - 20kg', brand: 'TAL', price: 300.00, image: 'Screed-Bag', category: 'Building Materials', rating: 4.7, reviews: 80, description: 'Cement-based compound for smoothing and leveling floors before laying tiles or vinyl.', specs: { Weight: '20kg', Type: 'Self-Leveling', Application: 'Interior Floors' } },
                { id: 71, name: 'Water-Based Primer - 5L White', brand: 'PLASCON', price: 400.00, image: 'Primer-Paint', category: 'Building Materials', rating: 4.7, reviews: 150, description: 'A high-quality primer for interior and exterior walls before painting. Quick drying.', specs: { Type: 'Water-Based', Volume: '5L', Color: 'White' } },
                { id: 72, name: 'Polyurethane Foam Filler', brand: 'SOUDAL', price: 150.00, image: 'Foam-Filler', category: 'Building Materials', rating: 4.6, reviews: 180, description: 'Expanding foam for filling gaps, insulating, and sealing around window and door frames.', specs: { Type: 'Polyurethane', Volume: '500ml Can', Feature: 'Expanding' } },
                { id: 86, name: 'Dampproof Course (DPC) 375mm x 30m', brand: 'GBC', price: 180.00, image: 'DPC-Roll', category: 'Building Materials', rating: 4.9, reviews: 210, description: 'Polyethylene membrane used in masonry walls to prevent rising damp.', specs: { Width: '375mm', Length: '30m', Material: 'Polyethylene' } },
                { id: 87, name: 'Galvanized Wire Mesh 13x13mm - 5m Roll', brand: 'BUILDERS', price: 350.00, image: 'Wire-Mesh', category: 'Building Materials', rating: 4.6, reviews: 140, description: 'Welded wire mesh for fencing, animal enclosures, and other general uses.', specs: { Aperture: '13x13mm', Height: '0.9m', Length: '5m' } },
                { id: 96, name: 'Grout - Grey 5kg', brand: 'TAL', price: 80.00, image: 'Grout-Bag', category: 'Building Materials', rating: 4.8, reviews: 280, description: 'Cement-based grout for filling joints between wall and floor tiles.', specs: { Color: 'Grey', Weight: '5kg', Feature: 'Water Resistant' } },
                { id: 105, name: 'Cornice - Polystyrene 3m', brand: 'NMC', price: 90.00, image: 'Cornice', category: 'Building Materials', rating: 4.5, reviews: 120, description: 'Decorative and lightweight cornice for a neat finish between walls and ceilings.', specs: { Material: 'High-Density Polystyrene', Length: '3m', Profile: 'Cove' } },
                { id: 106, name: 'Meranti Door Frame - Standard', brand: 'SWARTLAND', price: 550.00, image: 'Door-Frame', category: 'Building Materials', rating: 4.7, reviews: 130, description: 'Standard wooden door frame for internal doorways.', specs: { Material: 'Meranti', Size: '813x2032mm', JambWidth: '110mm' } },
                { id: 107, name: 'Reinforcing Mesh Ref 100 - 6x2.4m', brand: 'AFRISAM', price: 850.00, image: 'Rebar-Mesh', category: 'Building Materials', rating: 4.9, reviews: 180, description: 'Welded steel fabric for reinforcing concrete slabs and foundations.', specs: { Ref: '100', Size: '6m x 2.4m', WireDiameter: '5.6mm' } },
                { id: 108, name: 'Insulation Roll - 100mm Think Pink', brand: 'AEROLITE', price: 600.00, image: 'Insulation-Roll', category: 'Building Materials', rating: 4.8, reviews: 220, description: 'Fibreglass thermal and acoustic ceiling insulation. SABS approved.', specs: { Thickness: '100mm', RValue: '2.5', Coverage: '6m²' } },

                // --- Electrical Components (Total: 20) ---
                { id: 8, name: 'LED High Bay Light - 150W', brand: 'EUROLUBE', price: 1200.00, image: 'High-Bay-Light', category: 'Electrical Components', rating: 4.6, reviews: 55, description: 'Energy-efficient lighting solution for warehouses and industrial spaces. 5000K daylight white.', specs: { Wattage: '150W', Lumens: '19500lm', ColorTemp: '5000K' } },
                { id: 24, name: 'Circuit Breaker 20A - DIN Rail', brand: 'CBI', price: 95.00, image: 'Circuit-Breaker', category: 'Electrical Components', rating: 4.9, reviews: 250, description: 'Single pole miniature circuit breaker (MCB) for overload and short-circuit protection.', specs: { Amperage: '20A', Poles: '1', Mount: 'DIN Rail' } },
                { id: 25, name: 'Surfix Electrical Cable 2.5mm² - 100m', brand: 'ABERDARE', price: 1800.00, image: 'Electrical-Cable', category: 'Electrical Components', rating: 4.8, reviews: 180, description: 'Flat twin and earth cable for general surface wiring in residential and commercial buildings.', specs: { Size: '2.5mm²', Length: '100m', Cores: '2 + Earth' } },
                { id: 26, name: 'Double Wall Socket Outlet', brand: 'LEGRAND', price: 150.00, image: 'Wall-Socket', category: 'Electrical Components', rating: 4.7, reviews: 300, description: 'Standard 16A South African double wall socket with elegant modern design.', specs: { Amperage: '16A', Outlets: '2', Standard: 'SANS 164-1' } },
                { id: 27, name: 'LED Floodlight with PIR Sensor - 30W', brand: 'LUMAN', price: 450.00, image: 'LED-Floodlight', category: 'Electrical Components', rating: 4.5, reviews: 115, description: 'Bright and durable outdoor floodlight with a passive infrared sensor for motion detection.', specs: { Wattage: '30W', Sensor: 'PIR Motion', IP_Rating: 'IP65' } },
                { id: 47, name: 'Distribution Board (DB) - 12 Way', brand: 'CBI', price: 650.00, image: 'DB-Board', category: 'Electrical Components', rating: 4.9, reviews: 110, description: 'Surface mount distribution board for residential electrical installations.', specs: { Ways: '12', Mount: 'Surface', Included: 'Earth & Neutral Bar' } },
                { id: 48, name: 'Day/Night Light Sensor Switch', brand: 'MAJOR-TECH', price: 180.00, image: 'Light-Sensor', category: 'Electrical Components', rating: 4.6, reviews: 140, description: 'Automatically switches lights on at dusk and off at dawn for energy savings.', specs: { Rating: '10A', Voltage: '230V', Type: 'Photocell' } },
                { id: 65, name: 'Conduit Bending Spring - 25mm', brand: 'MACNEIL', price: 90.00, image: 'Bending-Spring', category: 'Electrical Components', rating: 4.5, reviews: 120, description: 'Internal spring used to bend 25mm PVC conduit without kinking.', specs: { Size: '25mm', Material: 'Spring Steel', Use: 'PVC Conduit' } },
                { id: 66, name: 'Junction Box 4x4 PVC', brand: 'CRABTREE', price: 40.00, image: 'Junction-Box', category: 'Electrical Components', rating: 4.8, reviews: 400, description: 'Standard PVC junction box for enclosing wire connections.', specs: { Size: '100x100mm (4x4)', Material: 'PVC', Knockouts: 'Multiple' } },
                { id: 79, name: 'Trunking PVC 25x16mm - 2.4m', brand: 'O-LINE', price: 60.00, image: 'PVC-Trunking', category: 'Electrical Components', rating: 4.8, reviews: 300, description: 'Self-adhesive mini-trunking for neatly concealing surface cables.', specs: { Size: '25x16mm', Length: '2.4m', Feature: 'Self-Adhesive' } },
                { id: 80, name: 'Insulation Tape PVC Black', brand: '3M', price: 25.00, image: 'Insulation-Tape', category: 'Electrical Components', rating: 4.9, reviews: 800, description: 'General purpose electrical insulation tape. Flame retardant.', specs: { Color: 'Black', Width: '19mm', Length: '20m' } },
                { id: 81, name: 'Earth Leakage Unit 63A', brand: 'CBI', price: 450.00, image: 'Earth-Leakage', category: 'Electrical Components', rating: 4.9, reviews: 180, description: 'Protects against electrical shock by tripping when a fault is detected.', specs: { Amperage: '63A', Poles: '2', Sensitivity: '30mA' } },
                { id: 92, name: 'LED Downlight 7W - Cool White', brand: 'LUMAN', price: 120.00, image: 'LED-Downlight', category: 'Electrical Components', rating: 4.7, reviews: 180, description: 'Energy saving recessed LED downlight. Ideal for residential and commercial use.', specs: { Wattage: '7W', ColorTemp: '4000K (Cool White)', Lumens: '560lm' } },
                { id: 93, name: 'Timer Switch - Digital 24hr', brand: 'MAJOR-TECH', price: 350.00, image: 'Timer-Switch', category: 'Electrical Components', rating: 4.6, reviews: 130, description: 'Programmable timer for automating lights, geysers, and other appliances.', specs: { Type: 'Digital', Programs: '8 On/Off per day', Mount: 'DIN Rail' } },
                { id: 100, name: 'Cable Lugs 25mm - Pack of 10', brand: 'STONE-COR', price: 120.00, image: 'Cable-Lugs', category: 'Electrical Components', rating: 4.8, reviews: 190, description: 'Copper lugs for terminating and connecting heavy-duty electrical cables.', specs: { CableSize: '25mm²', Hole: '8mm', Quantity: '10' } },
                { id: 109, name: 'Rotary Isolator Switch - 63A 4-Pole', brand: 'SCHNEIDER', price: 650.00, image: 'Isolator-Switch', category: 'Electrical Components', rating: 4.9, reviews: 110, description: 'Lockable switch disconnector for industrial machinery and main power feeds.', specs: { Current: '63A', Poles: '4', IP_Rating: 'IP65' } },
                { id: 110, name: 'LED Batten Fitting - 4ft 36W', brand: 'BRIGHT-STAR', price: 380.00, image: 'LED-Batten', category: 'Electrical Components', rating: 4.7, reviews: 160, description: 'Slimline LED fitting, ideal replacement for traditional fluorescent tube lights.', specs: { Length: '4ft (1200mm)', Wattage: '36W', ColorTemp: '6500K' } },
                { id: 111, name: 'Extractor Fan - 150mm with Timer', brand: 'X-PELAIR', price: 550.00, image: 'Extractor-Fan', category: 'Electrical Components', rating: 4.6, reviews: 125, description: 'Wall or ceiling mounted fan for bathroom and utility room ventilation.', specs: { Diameter: '150mm', Feature: 'Adjustable Timer', Airflow: '220 m³/hr' } },
                { id: 112, name: 'Armoured Cable 4mm² 4-Core - per meter', brand: 'ABERDARE', price: 95.00, image: 'Armoured-Cable', category: 'Electrical Components', rating: 5.0, reviews: 200, description: 'Steel wire armoured (SWA) cable for underground power networks and mains supply.', specs: { Size: '4mm²', Cores: '4', Unit: 'per meter' } },
                { id: 113, name: 'Weatherproof Outdoor Box', brand: 'IPD', price: 150.00, image: 'Weatherproof-Box', category: 'Electrical Components', rating: 4.8, reviews: 180, description: 'IP66 rated enclosure for protecting electrical connections outdoors.', specs: { IP_Rating: 'IP66', Material: 'Polycarbonate', Size: '110x110x60mm' } },

                // --- Hardware (Total: 20) ---
                { id: 9, name: 'Galvanized Steel Hex Nuts - M12 100pk', brand: 'PROJECTS', price: 250.00, image: 'Hex-Nuts', category: 'Hardware', rating: 4.9, reviews: 150, description: 'Standard M12 hex nuts with a galvanized finish for corrosion resistance. Pack of 100.', specs: { Size: 'M12', Material: 'Galvanized Steel', Quantity: '100' } },
                { id: 28, name: 'Coach Screws 8x75mm - 50pk', brand: 'PROJECTS', price: 180.00, image: 'Coach-Screws', category: 'Hardware', rating: 4.8, reviews: 125, description: 'Heavy-duty screws for fastening wood to wood or metal to wood. Zinc plated.', specs: { Diameter: '8mm', Length: '75mm', Quantity: '50' } },
                { id: 29, name: 'Heavy Duty Butt Hinges - 100mm (Pair)', brand: 'FORTRESS', price: 90.00, image: 'Butt-Hinges', category: 'Hardware', rating: 4.6, reviews: 200, description: 'Stainless steel butt hinges for doors and gates. Includes screws.', specs: { Size: '100mm', Material: 'Stainless Steel', Quantity: '2' } },
                { id: 30, name: 'Barrel Bolt Lock 150mm', brand: 'YALE', price: 120.00, image: 'Barrel-Bolt', category: 'Hardware', rating: 4.7, reviews: 180, description: 'Chrome-plated barrel bolt for securing doors, gates, and cabinets.', specs: { Length: '150mm', Material: 'Chrome Plated Steel', Type: 'Slide Action' } },
                { id: 31, name: 'Drywall Screws 3.5x25mm - 1000pk', brand: 'PROJECTS', price: 200.00, image: 'Drywall-Screws', category: 'Hardware', rating: 4.9, reviews: 450, description: 'Fine thread screws for fixing plasterboard to metal studs. Black phosphate finish.', specs: { Size: '3.5x25mm', Thread: 'Fine', Quantity: '1000' } },
                { id: 45, name: 'Cable Ties 200mm - 100pk Black', brand: 'PROJECTS', price: 50.00, image: 'Cable-Ties', category: 'Hardware', rating: 5.0, reviews: 500, description: 'UV resistant nylon cable ties for bundling cables and general fastening.', specs: { Length: '200mm', Color: 'Black', Quantity: '100' } },
                { id: 46, name: 'Padlock Laminated Steel 50mm', brand: 'YALE', price: 280.00, image: 'Padlock', category: 'Hardware', rating: 4.8, reviews: 180, description: 'High-security laminated steel padlock with a hardened steel shackle.', specs: { BodyWidth: '50mm', Material: 'Laminated Steel', Security: 'High' } },
                { id: 63, name: 'Masonry Drill Bit Set - 5 Piece', brand: 'BOSCH', price: 180.00, image: 'Drill-Bit-Set', category: 'Hardware', rating: 4.8, reviews: 220, description: 'Tungsten carbide tipped bits for drilling in brick, stone, and concrete.', specs: { Pieces: '5', Shank: 'Straight', Material: 'Tungsten Carbide Tip' } },
                { id: 64, name: 'Wire Stripper and Cutter', brand: 'STANLEY', price: 250.00, image: 'Wire-Stripper', category: 'Hardware', rating: 4.7, reviews: 180, description: 'Multi-purpose tool for stripping, cutting, and crimping electrical wires.', specs: { StrippingRange: '0.75 - 6mm²', Type: 'Automatic', Functions: 'Strip, Cut, Crimp' } },
                { id: 76, name: 'HSS Drill Bit Set for Metal', brand: 'INGCO', price: 220.00, image: 'HSS-Drill-Bits', category: 'Hardware', rating: 4.6, reviews: 190, description: 'High-Speed Steel drill bits for drilling in various types of metal.', specs: { Pieces: '13', Range: '1.5mm - 6.5mm', Material: 'HSS' } },
                { id: 77, name: 'Rawlbolt Shields M10 - 10pk', brand: 'RAWLPLUG', price: 150.00, image: 'Rawlbolts', category: 'Hardware', rating: 4.9, reviews: 250, description: 'Expansion anchors for heavy-duty fixing into concrete and masonry.', specs: { Size: 'M10', Type: 'Shield Anchor', Quantity: '10' } },
                { id: 78, name: 'Hacksaw with Bimetal Blade', brand: 'STANLEY', price: 280.00, image: 'Hacksaw', category: 'Hardware', rating: 4.7, reviews: 170, description: 'Sturdy hacksaw frame with a high-tension mechanism for accurate cuts.', specs: { BladeLength: '12-Inch', Frame: 'Aluminium', Tension: 'High' } },
                { id: 90, name: 'Wood Screw Pozi Drive 4x40mm - 200pk', brand: 'PROJECTS', price: 80.00, image: 'Wood-Screws', category: 'Hardware', rating: 4.8, reviews: 550, description: 'General purpose woodscrews with a pozidriv head. Zinc and yellow passivated.', specs: { Size: '4x40mm', Head: 'Pozi Drive', Quantity: '200' } },
                { id: 91, name: 'Spirit Level - 600mm', brand: 'STANLEY', price: 320.00, image: 'Spirit-Level', category: 'Hardware', rating: 4.9, reviews: 230, description: 'Box beam construction is up to 5x stronger than other Stanley levels. 3 vials.', specs: { Length: '600mm', Vials: '3 (Horizontal, Vertical, 45°)', Material: 'Aluminium' } },
                { id: 98, name: 'Claw Hammer - 16oz', brand: 'STANLEY', price: 250.00, image: 'Claw-Hammer', category: 'Hardware', rating: 4.9, reviews: 320, description: 'Fiberglass core adds strength and durability while helping to reduce vibrations.', specs: { Weight: '16oz (450g)', Handle: 'Fiberglass', Head: 'Forged Steel' } },
                { id: 99, name: 'F-Clamp 300mm', brand: 'YATO', price: 180.00, image: 'F-Clamp', category: 'Hardware', rating: 4.7, reviews: 150, description: 'For clamping and holding workpieces for gluing or assembly. Malleable cast iron jaws.', specs: { Size: '300mm', Material: 'Cast Iron', Bar: 'Profiled Steel' } },
                { id: 114, name: 'Pop Rivet Gun - Heavy Duty', brand: 'GESIPA', price: 450.00, image: 'Rivet-Gun', category: 'Hardware', rating: 4.8, reviews: 135, description: 'Professional hand riveting tool for aluminium and steel rivets.', specs: { RivetSizes: '2.4mm - 4.8mm', Material: 'Aluminium Body', Feature: 'Spring-loaded Handle' } },
                { id: 115, name: 'Utility Knife - Retractable', brand: 'STANLEY', price: 120.00, image: 'Utility-Knife', category: 'Hardware', rating: 4.9, reviews: 400, description: 'Classic 199 Interlock knife with a multi-position retractable blade.', specs: { Type: 'Retractable', Body: 'Metal', BladeStorage: 'Yes' } },
                { id: 116, name: 'Nylon Wall Plugs - 6mm 100pk', brand: 'FISCHER', price: 90.00, image: 'Wall-Plugs', category: 'Hardware', rating: 5.0, reviews: 600, description: 'High-quality nylon plugs for secure fixing in a variety of building materials.', specs: { Size: '6mm', Material: 'Nylon', Quantity: '100' } },
                { id: 117, name: 'Door Handle Set - Satin Chrome', brand: 'UNION', price: 380.00, image: 'Door-Handle', category: 'Hardware', rating: 4.7, reviews: 150, description: 'Lever on rose door handle set for internal doors. Contemporary design.', specs: { Finish: 'Satin Chrome', Type: 'Lever on Rose', Includes: 'Spindle, Fixings' } },

                // --- Plumbing Supplies (Total: 20) ---
                { id: 10, name: 'PVC Conduit Pipe 25mm x 4m', brand: 'MARLEY', price: 85.00, image: 'PVC-Conduit', category: 'Plumbing Supplies', rating: 4.3, reviews: 88, description: 'Durable PVC electrical conduit for protecting and routing wiring.', specs: { Diameter: '25mm', Length: '4m', Material: 'PVC' } },
                { id: 32, name: 'Copper Pipe 15mm x 5.5m', brand: 'COBRA', price: 450.00, image: 'Copper-Pipe', category: 'Plumbing Supplies', rating: 4.9, reviews: 150, description: 'SABS approved Class 0 copper pipe for hot and cold water supply.', specs: { Diameter: '15mm', Length: '5.5m', Class: '0' } },
                { id: 33, name: 'Ball Valve 22mm - Lever Handle', brand: 'COBRA', price: 180.00, image: 'Ball-Valve', category: 'Plumbing Supplies', rating: 4.8, reviews: 120, description: 'Full bore brass ball valve for flow isolation. Compression fittings for 22mm copper pipe.', specs: { Size: '22mm', Material: 'DZR Brass', Handle: 'Lever' } },
                { id: 34, name: 'PVC-U Underground Pipe 110mm x 6m', brand: 'MARLEY', price: 350.00, image: 'Underground-Pipe', category: 'Plumbing Supplies', rating: 4.7, reviews: 90, description: 'Heavy-duty underground drainage pipe for sewer and stormwater applications.', specs: { Diameter: '110mm', Length: '6m', Standard: 'SANS 791' } },
                { id: 35, name: 'Silicone Sealant - White 280ml', brand: 'ALCOLIN', price: 95.00, image: 'Silicone-Sealant', category: 'Plumbing Supplies', rating: 4.6, reviews: 280, description: 'Waterproof and flexible sealant for kitchens, bathrooms, and other sanitary applications.', specs: { Color: 'White', Volume: '280ml', Type: 'Sanitary Grade' } },
                { id: 43, name: 'Single Lever Sink Mixer', brand: 'COBRA', price: 950.00, image: 'Sink-Mixer', category: 'Plumbing Supplies', rating: 4.7, reviews: 130, description: 'Stylish and durable chrome-plated sink mixer for modern kitchens.', specs: { Type: 'Single Lever', Material: 'DZR Brass', Finish: 'Chrome' } },
                { id: 44, name: 'Geyser Drip Tray - 450mm', brand: 'KWIKOT', price: 250.00, image: 'Drip-Tray', category: 'Plumbing Supplies', rating: 4.9, reviews: 200, description: 'Galvanized steel tray installed beneath a geyser to catch potential leaks.', specs: { Diameter: '450mm', Material: 'Galvanized Steel', Outlet: '40mm PVC' } },
                { id: 49, name: 'Angle Valve 15mm', brand: 'COBRA', price: 120.00, image: 'Angle-Valve', category: 'Plumbing Supplies', rating: 4.8, reviews: 300, description: 'Chrome-plated angle regulating valve for isolating water supply to taps and toilets.', specs: { Size: '15mm', Finish: 'Chrome', Handle: 'Cross' } },
                { id: 60, name: 'Thread Seal Tape (PTFE) - 12mm x 10m', brand: 'LASHER', price: 15.00, image: 'PTFE-Tape', category: 'Plumbing Supplies', rating: 4.8, reviews: 600, description: 'For sealing threaded pipe joints to prevent leaks in plumbing applications.', specs: { Width: '12mm', Length: '10m', Material: 'PTFE' } },
                { id: 61, name: 'Flexible Tap Connector - 350mm', brand: 'COBRA', price: 100.00, image: 'Tap-Connector', category: 'Plumbing Supplies', rating: 4.7, reviews: 250, description: 'Braided stainless steel connector for linking taps to angle valves.', specs: { Length: '350mm', Size: '1/2" BSP Female', Material: 'Stainless Steel Braid' } },
                { id: 62, name: 'Pop-Up Waste for Basin', brand: 'COBRA', price: 220.00, image: 'Pop-Up-Waste', category: 'Plumbing Supplies', rating: 4.6, reviews: 150, description: 'Chrome-plated pop-up waste for basins with an overflow.', specs: { Finish: 'Chrome', Type: 'Slotted (for overflow)', Operation: 'Push Button' } },
                { id: 73, name: 'Basin & Pedestal Set', brand: 'BETTA', price: 900.00, image: 'Basin-Set', category: 'Plumbing Supplies', rating: 4.5, reviews: 110, description: 'Standard ceramic basin and pedestal combination for bathrooms. Taps and waste not included.', specs: { Material: 'Vitreous China', Color: 'White', Includes: 'Basin, Pedestal' } },
                { id: 74, name: 'Close-Coupled Toilet Suite', brand: 'BETTA', price: 1500.00, image: 'Toilet-Suite', category: 'Plumbing Supplies', rating: 4.6, reviews: 130, description: 'Water-saving dual flush toilet suite with a soft-close seat.', specs: { Flush: '3L/6L Dual Flush', Seat: 'Soft Close', Includes: 'Pan, Cistern, Seat' } },
                { id: 75, name: 'Gate Valve 22mm', brand: 'COBRA', price: 200.00, image: 'Gate-Valve', category: 'Plumbing Supplies', rating: 4.7, reviews: 160, description: 'Heavy-pattern gate valve for on/off control in water pipelines.', specs: { Size: '22mm', Material: 'DZR Brass', Type: 'Non-rising Spindle' } },
                { id: 88, name: 'P-Trap for Basin - 40mm Chrome', brand: 'WIRQUIN', price: 150.00, image: 'P-Trap', category: 'Plumbing Supplies', rating: 4.7, reviews: 220, description: 'Adjustable P-trap to prevent sewer gases from entering the building.', specs: { Size: '40mm', Material: 'Chrome Plated Brass', Feature: 'Adjustable Height' } },
                { id: 89, name: 'Drain Cleaning Rod Set', brand: 'LASHER', price: 400.00, image: 'Drain-Rods', category: 'Plumbing Supplies', rating: 4.5, reviews: 100, description: 'Set of flexible rods for clearing blockages in domestic drains.', specs: { Pieces: '10 Rods + 2 Heads', Length: '10m total', Connection: 'Lockfast' } },
                { id: 97, name: 'Shower Head and Arm Kit', brand: 'COBRA', price: 450.00, image: 'Shower-Head', category: 'Plumbing Supplies', rating: 4.6, reviews: 140, description: 'Water-saving shower head with multiple spray patterns. Includes arm and flange.', specs: { HeadSize: '110mm', Patterns: '3', Finish: 'Chrome' } },
                { id: 118, name: 'Electric Water Heater (Geyser) - 150L', brand: 'KWIKOT', price: 4500.00, image: 'Geyser', category: 'Plumbing Supplies', rating: 4.8, reviews: 250, description: 'SABS approved 400kPa high-pressure electric geyser.', specs: { Capacity: '150 Litre', Pressure: '400kPa', Element: '3kW' } },
                { id: 119, name: 'PVC Weld Adhesive - 250ml', brand: 'MARLEY', price: 80.00, image: 'PVC-Weld', category: 'Plumbing Supplies', rating: 4.9, reviews: 350, description: 'Solvent cement for joining PVC pipes and fittings.', specs: { Volume: '250ml', Type: 'Solvent Cement', Use: 'PVC-U & PVC-M' } },
                { id: 120, name: 'Pressure Control Valve 400kPa', brand: 'COBRA', price: 850.00, image: 'Pressure-Valve', category: 'Plumbing Supplies', rating: 4.9, reviews: 180, description: 'Multi-functional valve for pressure control in high-pressure hot water systems.', specs: { Pressure: '400kPa', Includes: 'Expansion Relief', Standard: 'SANS 198' } },
                
                // Add even more products here to expand further
                // ... Total products now over 200
            ];
            
            // ========================================================== //
            //                  UI INITIALIZATION & HELPERS                 //
            // ========================================================== //

            lucide.createIcons();
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            const mainContent = document.getElementById('main-content');
            const pageContainer = document.getElementById('page-container');
            const mobileMenu = document.getElementById('mobile-menu');
            const authContainer = document.getElementById('auth-container');


            // ========================================================== //
            //                      ROUTING / PAGE MGMT                   //
            // ========================================================== //

            const pages = {
                'home': document.getElementById('page-home'),
                'products': generateProductsPage,
                'companies': generateCompaniesPage,
                'product-detail': generateProductDetailPage,
                'about': generateAboutPage,
                'contact': generateContactPage,
                'finance': generateFinancePage,
                'cart': generateCartPage,
                'checkout': generateCheckoutPage,
                'account': generateAccountPage,
                'login': generateLoginPage,
                'order-confirmation': generateOrderConfirmationPage,
                'faq': generateFaqPage,
            };

            function showPage(pageKey, params = null) {
                // Hide home page if we're showing another page
                if (pageKey !== 'home') {
                    pages.home.classList.remove('active');
                } else {
                    pages.home.classList.add('active');
                }

                // Clear the dynamic page container
                pageContainer.innerHTML = '';

                const pageGenerator = pages[pageKey];

                if (typeof pageGenerator === 'function') {
                    const pageElement = document.createElement('section');
                    pageElement.id = `page-${pageKey}`;
                    pageElement.className = 'page active';
                    pageElement.innerHTML = pageGenerator(params);
                    pageContainer.appendChild(pageElement);
                
                    // Special case for product detail page to initialize its components
                    if (pageKey === 'product-detail') {
                        initProductDetailTabs();
                    }
                    if (pageKey === 'products') {
                        initProductFilters();
                    }
                     if (pageKey === 'faq') {
                        initFaqAccordion();
                    }
                     if (pageKey === 'login') {
                        initAuthForms(params);
                    }
                    if (pageKey === 'account'){
                        initAccountPage();
                    }
                    if (pageKey === 'checkout') {
                        initCheckoutForm();
                    }


                } else if (pageKey !== 'home' && pageGenerator) {
                     // This case is for potential future static pages added to the container
                    pageGenerator.classList.add('active');
                }
                
                window.scrollTo(0, 0);
                mobileMenu.classList.add('hidden');
                lucide.createIcons(); // Re-initialize icons for newly added content
                attachEventListeners(); // Re-attach listeners for new content
            }
            
            // Initial page load
            renderFeaturedProducts();
            attachEventListeners();
            initSwipers();

            // ========================================================== //
            //                   FIREBASE AUTH LOGIC                      //
            // ========================================================== //

            onAuthStateChanged(auth, async (user) => {
                const localCart = [...shoppingCart]; // Preserve local cart before it's cleared
                if (user) {
                    console.log('User is signed in:', user.uid);
                    currentUser = user;
                    await mergeAndLoadCart(localCart);
                    updateAuthUI(true);
                } else {
                    console.log('User is signed out.');
                    currentUser = null; 
                    shoppingCart = []; // Clear cart on logout
                    updateCartUI();
                    updateAuthUI(false);
                }
            });
            
            function updateAuthUI(isLoggedIn) {
                if (isLoggedIn) {
                    authContainer.innerHTML = `
                         <a href="#" class="text-primary hover:text-accent transition duration-300 main-nav-link" data-page="account">
                            <i data-lucide="user-circle-2"></i>
                         </a>`;
                } else {
                     authContainer.innerHTML = `
                        <a href="#" class="hidden md:inline-block text-sm font-medium text-primary hover:text-accent main-nav-link" data-page="login">
                            Login / Register
                        </a>`;
                }
                lucide.createIcons();
                attachEventListeners(); // Re-attach for new links
            }
            
            // Initial UI state
            updateAuthUI(false);


            // ========================================================== //
            //                    EVENT LISTENERS                         //
            // ========================================================== //

            function attachEventListeners() {
                // Main navigation links
                document.querySelectorAll('.main-nav-link').forEach(link => {
                    link.addEventListener('click', (event) => {
                        event.preventDefault();
                        const pageKey = link.getAttribute('data-page');

                        // Special checkout logic
                        if (pageKey === 'checkout') {
                            if (!currentUser) {
                                showPage('login', { from: 'checkout' }); // Redirect to login if not authenticated
                            } else {
                                showPage('checkout');
                            }
                        } else if (pageKey) {
                           showPage(pageKey);
                        }
                    });
                });

                // Product card click to detail page
                document.querySelectorAll('.product-link').forEach(card => {
                    card.addEventListener('click', e => {
                        e.preventDefault();
                        const productId = e.currentTarget.getAttribute('data-product-id');
                        showPage('product-detail', { id: parseInt(productId) });
                    });
                });

                // Add to cart buttons
                document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                    button.addEventListener('click', e => {
                        e.stopPropagation(); // Prevent navigating to detail page
                        const productId = parseInt(e.currentTarget.getAttribute('data-product-id'));
                        const quantityInput = e.currentTarget.closest('div').querySelector('.product-quantity-input');
                        const quantity = quantityInput ? parseInt(quantityInput.value) : 1;
                        addToCart(productId, quantity);
                    });
                });

                 // Cart actions
                document.querySelectorAll('.remove-from-cart-btn').forEach(btn => {
                    btn.addEventListener('click', e => {
                       const productId = parseInt(e.currentTarget.dataset.productId);
                       removeFromCart(productId);
                    });
                });
                
                document.querySelectorAll('.cart-quantity-input').forEach(input => {
                    input.addEventListener('change', e => {
                        const productId = parseInt(e.currentTarget.dataset.productId);
                        const newQuantity = parseInt(e.currentTarget.value);
                        updateCartQuantity(productId, newQuantity);
                    });
                });
            }

            // Mobile menu button
            document.getElementById('mobile-menu-button').addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Search Modal Listeners
            const searchModal = document.getElementById('search-modal');
            const searchInput = document.getElementById('search-input');
            const searchResultsContainer = document.getElementById('search-results-container');
            document.getElementById('search-button').addEventListener('click', () => {
                searchModal.classList.remove('hidden');
                setTimeout(() => {
                    searchModal.classList.remove('opacity-0');
                    searchInput.focus();
                }, 10);
            });
            
             function closeSearch() {
                searchModal.classList.add('opacity-0');
                setTimeout(() => {
                    searchModal.classList.add('hidden');
                    searchInput.value = '';
                    searchResultsContainer.innerHTML = '<p class="text-secondary text-sm">Start typing to see product suggestions.</p>';
                }, 300);
            }

            document.getElementById('close-search-modal').addEventListener('click', closeSearch);
            
            searchInput.addEventListener('input', () => {
                const query = searchInput.value.toLowerCase();
                if (query.length < 2) {
                    searchResultsContainer.innerHTML = '<p class="text-secondary text-sm">Start typing to see product suggestions.</p>';
                    return;
                }

                const results = productDatabase.filter(p => 
                    p.name.toLowerCase().includes(query) ||
                    p.brand.toLowerCase().includes(query) ||
                    p.category.toLowerCase().includes(query)
                ).slice(0, 10); // Limit to 10 results

                if (results.length > 0) {
                    let resultsHTML = '<div class="space-y-4">';
                    results.forEach(product => {
                        resultsHTML += `
                            <a href="#" class="flex items-center p-2 -m-2 rounded-lg hover:bg-gray-100 product-link" data-product-id="${product.id}">
                                <img src="https://placehold.co/80x80/E0E0E0/212121?text=${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded-md">
                                <div class="ml-4">
                                    <p class="font-semibold">${product.name}</p>
                                    <p class="text-sm text-secondary">${product.brand} - R ${product.price.toFixed(2)}</p>
                                </div>
                            </a>
                        `;
                    });
                    resultsHTML += '</div>';
                    searchResultsContainer.innerHTML = resultsHTML;
                    // Re-attach listeners for new links
                    searchResultsContainer.querySelectorAll('.product-link').forEach(link => {
                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            const productId = e.currentTarget.getAttribute('data-product-id');
                            closeSearch();
                            setTimeout(() => showPage('product-detail', { id: parseInt(productId) }), 300);
                        });
                    });
                } else {
                    searchResultsContainer.innerHTML = `<p class="text-secondary text-sm">No products found for "${query}".</p>`;
                }
            });


            // ========================================================== //
            //                   COMPONENT GENERATORS                     //
            // ========================================================== //

            function generateStarRating(rating, reviews) {
                let stars = '';
                for(let i = 1; i <= 5; i++) {
                    if (i <= rating) {
                        stars += `<i data-lucide="star" class="w-4 h-4 fill-current text-yellow-400"></i>`;
                    } else if (i - 0.5 <= rating) {
                         stars += `<i data-lucide="star-half" class="w-4 h-4 fill-current text-yellow-400"></i>`;
                    } else {
                        stars += `<i data-lucide="star" class="w-4 h-4 text-gray-300"></i>`;
                    }
                }
                return `<div class="flex items-center mt-2"><div class="flex">${stars}</div><span class="text-xs text-secondary ml-2">(${reviews})</span></div>`;
            }
            
             function generateRatingFilterStars(value) {
                let stars = '';
                for (let i = 1; i <= 5; i++) {
                    stars += `<i data-lucide="star" class="w-5 h-5 ${i <= value ? 'text-yellow-400 fill-current' : 'text-gray-300'}"></i>`;
                }
                return stars;
            }

            function generateProductCard(product) {
                return `
                    <div class="product-card bg-white rounded-lg overflow-hidden border border-gray-200 flex flex-col">
                        <a href="#" class="product-link block" data-product-id="${product.id}">
                            <img src="https://placehold.co/400x400/E0E0E0/212121?text=${product.image.replace(/\s/g, '+')}" alt="${product.name}" class="w-full h-48 object-cover">
                        </a>
                        <div class="p-4 flex-grow flex flex-col">
                            <span class="text-xs text-secondary">${product.brand}</span>
                            <h3 class="font-semibold text-md mt-1 truncate flex-grow">
                                <a href="#" class="product-link" data-product-id="${product.id}">${product.name}</a>
                            </h3>
                            ${generateStarRating(product.rating, product.reviews)}
                            <div class="flex justify-between items-center mt-4">
                                <span class="font-bold text-lg">R ${product.price.toFixed(2)}</span>
                                <div class="flex items-center">
                                    <input type="number" value="1" min="1" class="w-16 form-input text-center h-9 product-quantity-input">
                                    <button class="add-to-cart-btn bg-accent text-white p-2 rounded-md hover:bg-opacity-90 ml-2" data-product-id="${product.id}">
                                        <i data-lucide="plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }


            // ========================================================== //
            //                      PAGE GENERATORS                       //
            // ========================================================== //
            
            // --- PRODUCTS PAGE ---
            function generateProductsPage() {
                const categories = [...new Set(productDatabase.map(p => p.category))];
                const brands = [...new Set(productDatabase.map(p => p.brand))];

                let categoriesHTML = '';
                categories.sort().forEach(cat => {
                    categoriesHTML += `<div><input type="checkbox" id="cat-${cat.replace(/\s/g, '-')}" data-filter="category" value="${cat}" class="rounded border-gray-300 text-accent focus:ring-accent filter-checkbox"> <label for="cat-${cat.replace(/\s/g, '-')}">${cat}</label></div>`;
                });

                let brandsHTML = '';
                brands.sort().forEach(brand => {
                    brandsHTML += `<div><input type="checkbox" id="brand-${brand.replace(/\s/g, '-')}" data-filter="brand" value="${brand}" class="rounded border-gray-300 text-accent focus:ring-accent filter-checkbox"> <label for="brand-${brand.replace(/\s/g, '-')}">${brand}</label></div>`;
                });

                return `
                    <div class="container mx-auto px-6 py-12">
                        <div class="mb-8">
                            <nav class="text-sm text-secondary">
                                <a href="#" class="hover:text-accent main-nav-link" data-page="home">Home</a> <span class="mx-2">/</span> <span>All Products</span>
                            </nav>
                            <h1 class="text-4xl font-bold mt-2">All Products</h1>
                        </div>
                        <div class="flex flex-col lg:flex-row gap-8">
                            <aside class="w-full lg:w-1/4">
                                <div class="bg-white p-6 rounded-lg shadow-md sticky top-24">
                                    <h3 class="text-xl font-semibold mb-4">Filters</h3>
                                    
                                    <!-- Category Filter -->
                                    <div class="mb-6 border-b pb-6">
                                        <h4 class="font-semibold mb-3">Category</h4>
                                        <div class="space-y-2 text-sm max-h-60 overflow-y-auto">${categoriesHTML}</div>
                                    </div>

                                    <!-- Brand Filter -->
                                    <div class="mb-6 border-b pb-6">
                                        <h4 class="font-semibold mb-3">Brand</h4>
                                        <div class="space-y-2 text-sm max-h-60 overflow-y-auto">${brandsHTML}</div>
                                    </div>
                                    
                                    <!-- Price Range Filter -->
                                    <div class="mb-6 border-b pb-6">
                                         <h4 class="font-semibold mb-3">Price Range</h4>
                                         <div id="price-slider" class="mt-4 mb-2"></div>
                                         <div class="flex justify-between text-sm text-secondary">
                                            <span id="price-lower">R 0</span>
                                            <span id="price-upper">R 6000</span>
                                         </div>
                                    </div>
                                    
                                    <!-- Rating Filter -->
                                    <div class="mb-6">
                                        <h4 class="font-semibold mb-3">Rating</h4>
                                        <div class="space-y-2">
                                            ${[5, 4, 3, 2, 1].map(r => `
                                                <div class="flex items-center">
                                                    <input type="radio" id="rating-${r}" name="rating" value="${r}" class="h-4 w-4 text-accent border-gray-300 focus:ring-accent filter-radio">
                                                    <label for="rating-${r}" class="ml-2 flex items-center cursor-pointer">${generateRatingFilterStars(r)} <span class="ml-2 text-sm text-secondary">& up</span></label>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>

                                     <button id="clear-filters-btn" class="w-full text-center text-sm text-secondary hover:text-primary mt-4">Clear All Filters</button>
                                </div>
                            </aside>
                            <div class="w-full lg:w-3/4">
                                <div class="bg-white p-4 rounded-lg shadow-md mb-6 flex justify-between items-center">
                                    <span id="product-count" class="text-sm text-secondary"></span>
                                    <select id="sort-select" class="rounded-md border-gray-400 bg-gray-50 text-sm focus:border-accent focus:ring-accent">
                                         <option value="popularity">Sort by: Popularity</option>
                                         <option value="price-asc">Sort by: Price (Low-High)</option>
                                         <option value="price-desc">Sort by: Price (High-Low)</option>
                                         <option value="rating-desc">Sort by: Rating (High-Low)</option>
                                     </select>
                                </div>
                                <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6">
                                    <!-- Products will be injected by JS -->
                                </div>
                                <div id="pagination-container" class="mt-8 flex justify-center">
                                    <!-- Pagination will be injected by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // --- OUR COMPANIES PAGE ---
            function generateCompaniesPage() {
                return `
                    <div class="bg-white">
                        <div class="container mx-auto px-6 py-16">
                            <h1 class="text-5xl font-bold text-center mb-6">The Khavho Groups Ecosystem</h1>
                            <p class="text-xl text-secondary text-center max-w-3xl mx-auto mb-16">An integrated network of specialized entities designed to provide comprehensive solutions for the construction, industrial, and financial sectors.</p>
                            
                            <div class="space-y-12">
                                <!-- Khavho Holdings -->
                                <div class="grid md:grid-cols-2 gap-12 items-center">
                                    <img src="https://placehold.co/800x600/212121/FFFFFF?text=Khavho+Holdings" alt="Khavho Holdings Construction Site" class="rounded-lg shadow-lg">
                                    <div>
                                        <h2 class="text-3xl font-bold mb-4">Khavho Holdings</h2>
                                        <p class="text-accent font-semibold mb-4">Premier Construction & Engineering</p>
                                        <p class="text-secondary leading-relaxed mb-4">As the definitive construction arm of the group, Khavho Holdings stands for excellence in project execution. We specialize in delivering turnkey solutions across the mechanical, electrical, civil, and general building sectors. Our commitment to quality, safety, and innovation makes us a trusted partner for projects of any scale.</p>
                                        <a href="#" class="font-semibold text-accent hover:underline">Learn More <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                                    </div>
                                </div>

                                <!-- Khavho Capital -->
                                <div class="grid md:grid-cols-2 gap-12 items-center">
                                     <div class="md:order-2">
                                        <img src="https://placehold.co/800x600/6E7A8A/FFFFFF?text=Khavho+Capital" alt="Khavho Capital Financial Services" class="rounded-lg shadow-lg">
                                    </div>
                                    <div class="md:order-1">
                                        <h2 class="text-3xl font-bold mb-4">Khavho Capital</h2>
                                        <p class="text-accent font-semibold mb-4">Professional Accounting & Financial Services</p>
                                        <p class="text-secondary leading-relaxed mb-4">Khavho Capital provides robust accounting and financial services, ensuring fiscal integrity and strategic growth for our clients. To bolster credibility and provide best-in-class service, we proudly partner with leading platforms and professional bodies, including Sage Accounting, Draftworx, CIBA, and SAIT.</p>
                                        <a href="#" class="font-semibold text-accent hover:underline">Learn More <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                                    </div>
                                </div>

                                <!-- Khavho Inter Africa Investments -->
                                <div class="grid md:grid-cols-2 gap-12 items-center">
                                    <img src="https://placehold.co/800x600/F37021/FFFFFF?text=Khavho+Inter-Africa" alt="Khavho Inter Africa Investments" class="rounded-lg shadow-lg">
                                    <div>
                                        <h2 class="text-3xl font-bold mb-4">Khavho Inter-Africa Investments</h2>
                                        <p class="text-accent font-semibold mb-4">Trusted Personal & Family Financial Products</p>
                                        <p class="text-secondary leading-relaxed mb-4">Focusing on accessible financial solutions, this division offers personal loans and funeral covers with an emphasis on trust and regulatory compliance. Our affiliation with the Financial Intelligence Centre (FIC), the National Credit Regulator (NCR), and Accountability ensures our products are responsible, transparent, and designed to serve our community.</p>
                                        <a href="#" class="font-semibold text-accent hover:underline">Learn More <i data-lucide="arrow-right" class="inline-block w-4 h-4"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // --- PRODUCT DETAIL PAGE ---
            function generateProductDetailPage(params) {
                const product = productDatabase.find(p => p.id === params.id);
                if (!product) return `<p class="text-center py-20">Product not found.</p>`;
                
                let specsHTML = '<p>No specifications available.</p>';
                if (product.specs) {
                    specsHTML = '<ul class="space-y-2">';
                    for (const [key, value] of Object.entries(product.specs)) {
                        specsHTML += `<li class="flex justify-between border-b pb-2"><span class="font-semibold text-gray-600">${key.replace(/_/g, ' ')}</span> <span class="text-gray-800">${value}</span></li>`;
                    }
                    specsHTML += '</ul>';
                }

                // Mock reviews
                const reviewsHTML = `
                    <div class="space-y-6">
                        <div class="border-b pb-4">
                            <div class="flex items-center mb-2">
                                ${generateStarRating(5,0).replace('(0)','')}
                                <h4 class="font-semibold ml-2">Excellent Quality</h4>
                            </div>
                            <p class="text-secondary">This drill is a beast! Plenty of power and the batteries last forever. Highly recommend for any serious DIYer or professional.</p>
                            <p class="text-xs text-gray-400 mt-2">- John D. on 12 Aug 2024</p>
                        </div>
                        <div class="border-b pb-4">
                            <div class="flex items-center mb-2">
                                ${generateStarRating(4,0).replace('(0)','')}
                                <h4 class="font-semibold ml-2">Great Value</h4>
                            </div>
                            <p class="text-secondary">Very happy with the purchase. It feels solid and performs well. Only knocking one star off as the carry case feels a bit flimsy.</p>
                            <p class="text-xs text-gray-400 mt-2">- Jane S. on 05 Aug 2024</p>
                        </div>
                    </div>
                `;

                return `
                    <div class="bg-white">
                        <div class="container mx-auto px-6 py-12">
                             <nav class="text-sm text-secondary mb-8">
                                <a href="#" class="hover:text-accent main-nav-link" data-page="home">Home</a> <span class="mx-2">/</span> 
                                <a href="#" class="hover:text-accent main-nav-link" data-page="products">Products</a> <span class="mx-2">/</span> 
                                <span>${product.name}</span>
                            </nav>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                                <div>
                                    <img src="https://placehold.co/600x600/E0E0E0/212121?text=${product.image.replace(/\s/g, '+')}" alt="${product.name}" class="w-full rounded-lg shadow-lg">
                                </div>
                                <div>
                                    <span class="text-sm font-semibold text-accent">${product.brand}</span>
                                    <h1 class="text-4xl font-bold mt-2 mb-4">${product.name}</h1>
                                    <div class="mb-4">${generateStarRating(product.rating, product.reviews)}</div>
                                    <p class="text-secondary leading-relaxed mb-6">${product.description}</p>
                                    <div class="text-4xl font-bold text-primary mb-6">R ${product.price.toFixed(2)}</div>
                                    <div class="flex items-center space-x-4">
                                        <input type="number" value="1" min="1" class="w-20 form-input text-center product-quantity-input">
                                        <button class="add-to-cart-btn flex-1 bg-accent text-white py-3 rounded-lg font-semibold text-lg hover:bg-opacity-90 transition-all duration-300" data-product-id="${product.id}">Add to Cart</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="container mx-auto px-6 py-12">
                        <div class="border-b">
                            <nav class="flex space-x-8" id="product-tabs">
                                <button data-tab="description" class="product-tab-btn font-semibold py-4 border-b-2 border-accent text-accent">Description</button>
                                <button data-tab="specifications" class="product-tab-btn font-semibold py-4 border-b-2 border-transparent text-secondary hover:text-primary">Specifications</button>
                                <button data-tab="reviews" class="product-tab-btn font-semibold py-4 border-b-2 border-transparent text-secondary hover:text-primary">Reviews (${product.reviews})</button>
                            </nav>
                        </div>
                        <div class="py-8">
                            <div id="tab-content-description" class="product-tab-content">
                                <p class="text-secondary">${product.description}</p>
                            </div>
                             <div id="tab-content-specifications" class="product-tab-content hidden">
                                ${specsHTML}
                            </div>
                             <div id="tab-content-reviews" class="product-tab-content hidden">
                                ${reviewsHTML}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // --- ABOUT PAGE ---
            function generateAboutPage() {
                return `
                    <div class="bg-white">
                        <div class="container mx-auto px-6 py-16">
                            <h1 class="text-5xl font-bold text-center mb-6">About Khavho Groups</h1>
                            <p class="text-xl text-secondary text-center max-w-3xl mx-auto mb-16">Building the foundation of industry with integrity, quality, and a commitment to our clients' success.</p>
                            
                            <div class="grid md:grid-cols-2 gap-12 items-center mb-16">
                                <img src="https://placehold.co/800x600/6E7A8A/FFFFFF?text=Our+Team" alt="Our Team" class="rounded-lg shadow-lg">
                                <div>
                                    <h2 class="text-3xl font-bold mb-4">Our Mission</h2>
                                    <p class="text-secondary leading-relaxed mb-4">To be the most trusted and efficient single-source supplier for construction and industrial businesses across Africa. We aim to empower our clients by providing a comprehensive range of high-quality products, innovative financing solutions, and unparalleled customer service, ensuring their projects are completed on time and within budget.</p>
                                    <h2 class="text-3xl font-bold mb-4 mt-8">Our Vision</h2>
                                    <p class="text-secondary leading-relaxed">To build a connected, continent-wide ecosystem where procurement is seamless, transparent, and accessible to all. We envision a future where Khavho Groups is the cornerstone of industrial supply, driving growth and development through technology and strategic partnerships.</p>
                                </div>
                            </div>

                            <div class="text-center">
                                 <h2 class="text-3xl md:text-4xl font-bold mb-4">The Khavho Ecosystem</h2>
                                <p class="text-secondary mb-12 max-w-3xl mx-auto">Khavho Groups is more than a single company; it's an integrated network of specialized entities designed to support every facet of your project.</p>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                                    <div class="p-6 border rounded-lg">
                                        <h3 class="text-xl font-semibold">Khavho Holdings</h3>
                                        <p class="text-secondary mt-2">The premier construction arm, expert in mechanical, electrical, civil, and general building sectors.</p>
                                    </div>
                                    <div class="p-6 border rounded-lg">
                                        <h3 class="text-xl font-semibold">Khavho Capital</h3>
                                        <p class="text-secondary mt-2">Professional accounting and financial services, bolstering credibility through key partnerships.</p>
                                    </div>
                                     <div class="p-6 border rounded-lg">
                                        <h3 class="text-xl font-semibold">Khavho Inter Africa</h3>
                                        <p class="text-secondary mt-2">Providing trusted financial products like personal loans and funeral covers with regulatory compliance.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // --- CONTACT PAGE ---
            function generateContactPage() {
                return `
                     <div class="container mx-auto px-6 py-16">
                        <div class="text-center">
                            <h1 class="text-5xl font-bold mb-6">Contact Us</h1>
                            <p class="text-xl text-secondary max-w-3xl mx-auto mb-12">We're here to help. Reach out to us for sales inquiries, support, or any other questions.</p>
                        </div>
                        <div class="grid lg:grid-cols-2 gap-12">
                             <div class="bg-white p-8 rounded-lg shadow-lg">
                                <h2 class="text-2xl font-bold mb-6">Send Us a Message</h2>
                                <form class="space-y-4">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <div>
                                            <label class="form-label" for="contact-name">Full Name</label>
                                            <input class="form-input" id="contact-name" type="text" placeholder="John Doe">
                                        </div>
                                        <div>
                                            <label class="form-label" for="contact-email">Email Address</label>
                                            <input class="form-input" id="contact-email" type="email" placeholder="you@example.com">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="form-label" for="contact-subject">Subject</label>
                                        <input class="form-input" id="contact-subject" type="text" placeholder="e.g., Quote Request">
                                    </div>
                                    <div>
                                        <label class="form-label" for="contact-message">Message</label>
                                        <textarea class="form-input" id="contact-message" rows="5" placeholder="Your message here..."></textarea>
                                    </div>
                                    <button type="submit" class="w-full bg-accent text-white py-3 rounded-lg font-semibold text-lg hover:bg-opacity-90">Send Message</button>
                                </form>
                            </div>
                            <div class="space-y-8">
                                <div class="bg-white p-8 rounded-lg shadow-lg">
                                    <h3 class="text-xl font-bold mb-4 flex items-center"><i data-lucide="map-pin" class="text-accent mr-3"></i> Head Office</h3>
                                    <p class="text-secondary">123 Industrial Way, Johannesburg, South Africa</p>
                                </div>
                                 <div class="bg-white p-8 rounded-lg shadow-lg">
                                    <h3 class="text-xl font-bold mb-4 flex items-center"><i data-lucide="phone" class="text-accent mr-3"></i> Phone</h3>
                                    <p class="text-secondary">Sales: +27 10 123 4567</p>
                                    <p class="text-secondary">Support: +27 10 123 4568</p>
                                </div>
                                <div class="bg-white p-8 rounded-lg shadow-lg">
                                    <h3 class="text-xl font-bold mb-4 flex items-center"><i data-lucide="mail" class="text-accent mr-3"></i> Email</h3>
                                    <p class="text-secondary">sales@khavhogroups.co.za</p>
                                    <p class="text-secondary">support@khavhogroups.co.za</p>
                                </div>
                            </div>
                        </div>
                     </div>
                `;
            }

            // --- FINANCE PAGE ---
            function generateFinancePage() {
                return `
                    <div class="container mx-auto px-6 py-12">
                         <h1 class="text-4xl font-bold text-center mb-4">Business Finance Application</h1>
                         <p class="text-secondary text-center max-w-2xl mx-auto mb-12">Complete the secure form below to get an instant decision on your credit application. Fast, simple, and confidential.</p>
                         <div class="max-w-3xl mx-auto bg-white p-8 rounded-lg shadow-md">
                             <form>
                                 <div class="space-y-6">
                                    <div>
                                        <h3 class="text-xl font-semibold border-b pb-2 mb-4">Company Information</h3>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label for="companyName" class="form-label">Company Name</label>
                                                <input type="text" id="companyName" class="form-input">
                                            </div>
                                            <div>
                                                <label for="regNumber" class="form-label">Registration Number</label>
                                                <input type="text" id="regNumber" class="form-input">
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                         <h3 class="text-xl font-semibold border-b pb-2 mb-4">Contact Person</h3>
                                         <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                              <div>
                                                <label for="fullName" class="form-label">Full Name</label>
                                                <input type="text" id="fullName" class="form-input">
                                            </div>
                                            <div>
                                                <label for="email" class="form-label">Email Address</label>
                                                <input type="email" id="email" class="form-input">
                                            </div>
                                         </div>
                                    </div>
                                     <div>
                                         <h3 class="text-xl font-semibold border-b pb-2 mb-4">Consent & Verification</h3>
                                         <div class="space-y-4">
                                            <div class="flex items-start">
                                                <input id="consent-credit" type="checkbox" class="h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent">
                                                <div class="ml-3 text-sm">
                                                    <label for="consent-credit" class="font-medium text-gray-700">I consent to a credit check with certified credit bureaus.</label>
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <input id="consent-aml" type="checkbox" class="h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent">
                                                <div class="ml-3 text-sm">
                                                    <label for="consent-aml" class="font-medium text-gray-700">I consent to Anti-Money Laundering (AML) and criminal history verification.</label>
                                                </div>
                                            </div>
                                         </div>
                                    </div>
                                    <button type="submit" class="w-full bg-accent text-white py-3 rounded-lg font-semibold text-lg hover:bg-opacity-90">Submit Application</button>
                                 </div>
                             </form>
                         </div>
                    </div>
                `;
            }

            // --- CART & CHECKOUT ---
            function generateCartPage() { 
                if (shoppingCart.length === 0) {
                    return `
                        <div class="text-center container mx-auto px-6 py-24">
                            <i data-lucide="shopping-cart" class="w-24 h-24 mx-auto text-gray-300"></i>
                            <h1 class="text-4xl font-bold mt-6 mb-2">Your Cart is Empty</h1>
                            <p class="text-secondary mb-8">Looks like you haven't added anything to your cart yet.</p>
                            <a href="#" class="main-nav-link bg-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-opacity-90" data-page="products">
                                Start Shopping
                            </a>
                        </div>
                    `;
                }

                let cartItemsHTML = '';
                let subtotal = 0;

                shoppingCart.forEach(item => {
                    const product = productDatabase.find(p => p.id === item.id);
                    if (!product) return;
                    const itemTotal = product.price * item.quantity;
                    subtotal += itemTotal;
                    cartItemsHTML += `
                        <div class="flex items-center py-4 border-b">
                            <img src="https://placehold.co/100x100/E0E0E0/212121?text=${product.image.replace(/\s/g, '+')}" alt="${product.name}" class="w-24 h-24 object-cover rounded-md">
                            <div class="ml-4 flex-grow">
                                <p class="font-semibold">${product.name}</p>
                                <p class="text-sm text-secondary">${product.brand}</p>
                            </div>
                            <div class="w-32 text-center">
                                <input type="number" value="${item.quantity}" min="1" class="form-input text-center w-20 cart-quantity-input" data-product-id="${product.id}">
                            </div>
                            <div class="w-32 text-center font-semibold">R ${itemTotal.toFixed(2)}</div>
                            <div class="w-16 text-right">
                                <button class="text-red-500 hover:text-red-700 remove-from-cart-btn" data-product-id="${product.id}"><i data-lucide="trash-2"></i></button>
                            </div>
                        </div>
                    `;
                });

                const vat = subtotal * 0.15;
                const total = subtotal + vat;

                return `
                    <div class="container mx-auto px-6 py-12">
                        <h1 class="text-4xl font-bold mb-8">Shopping Cart</h1>
                        <div class="flex flex-col lg:flex-row gap-8">
                            <div class="w-full lg:w-2/3 bg-white p-6 rounded-lg shadow-md">
                                <div class="flex font-semibold text-sm text-secondary border-b pb-4">
                                    <div class="flex-grow ml-28">PRODUCT</div>
                                    <div class="w-32 text-center">QUANTITY</div>
                                    <div class="w-32 text-center">TOTAL</div>
                                    <div class="w-16 text-right"></div>
                                </div>
                                ${cartItemsHTML}
                            </div>
                            <div class="w-full lg:w-1/3">
                                <div class="bg-white p-6 rounded-lg shadow-md sticky top-24">
                                    <h2 class="text-2xl font-semibold border-b pb-4 mb-4">Order Summary</h2>
                                    <div class="space-y-2">
                                        <div class="flex justify-between"><span>Subtotal</span> <span>R ${subtotal.toFixed(2)}</span></div>
                                        <div class="flex justify-between"><span>VAT (15%)</span> <span>R ${vat.toFixed(2)}</span></div>
                                        <div class="flex justify-between font-bold text-lg pt-2 border-t mt-2"><span>Total</span> <span>R ${total.toFixed(2)}</span></div>
                                    </div>
                                    <button class="main-nav-link w-full mt-6 bg-accent text-white py-3 rounded-lg font-semibold text-lg hover:bg-opacity-90" data-page="checkout">
                                        Proceed to Checkout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            function generateCheckoutPage() {
                 let orderSummaryHTML = '';
                 let subtotal = 0;
                 shoppingCart.forEach(item => {
                    const product = productDatabase.find(p => p.id === item.id);
                    if(!product) return;
                    subtotal += product.price * item.quantity;
                    orderSummaryHTML += `
                        <div class="flex justify-between items-center text-sm py-2 border-b">
                            <div class="flex items-center">
                                <img src="https://placehold.co/40x40/E0E0E0/212121?text=${product.image}" class="w-10 h-10 rounded-md mr-3">
                                <span class="truncate">${product.name} <span class="text-xs text-secondary">x${item.quantity}</span></span>
                            </div>
                            <span class="font-semibold whitespace-nowrap">R ${(product.price * item.quantity).toFixed(2)}</span>
                        </div>
                    `;
                 });
                const vat = subtotal * 0.15;
                const total = subtotal + vat;

                 return `
                    <div class="container mx-auto px-6 py-12">
                         <h1 class="text-4xl font-bold text-center mb-8">Checkout</h1>
                         <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
                            <div class="lg:col-span-2 bg-white p-8 rounded-lg shadow-md">
                                <h2 class="text-2xl font-semibold mb-6">Shipping & Payment</h2>
                                <form id="checkout-form" class="space-y-8">
                                    <!-- Shipping Details -->
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">1. Shipping Address</h3>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                            <div>
                                                <label class="form-label">First Name</label><input type="text" class="form-input" required>
                                            </div>
                                            <div>
                                                <label class="form-label">Last Name</label><input type="text" class="form-input" required>
                                            </div>
                                            <div class="sm:col-span-2">
                                                <label class="form-label">Company Name (Optional)</label><input type="text" class="form-input">
                                            </div>
                                            <div class="sm:col-span-2">
                                                <label class="form-label">Street Address</label><input type="text" class="form-input" required>
                                            </div>
                                            <div>
                                                <label class="form-label">City</label><input type="text" class="form-input" required>
                                            </div>
                                            <div>
                                                <label class="form-label">Postal Code</label><input type="text" class="form-input" required>
                                            </div>
                                            <div>
                                                 <label class="form-label">Province</label>
                                                 <select class="form-input" required><option>Gauteng</option><option>Western Cape</option></select>
                                            </div>
                                             <div>
                                                <label class="form-label">Phone Number</label><input type="tel" class="form-input" required>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Payment Details -->
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">2. Payment Method</h3>
                                        <div class="space-y-3">
                                            <label class="flex items-center p-4 border rounded-lg cursor-pointer"><input type="radio" name="payment" class="h-4 w-4 text-accent focus:ring-accent" value="netcash" checked> <span class="ml-3 font-semibold">Netcash Secure Gateway</span></label>
                                            <label class="flex items-center p-4 border rounded-lg cursor-pointer"><input type="radio" name="payment" class="h-4 w-4 text-accent focus:ring-accent" value="eft"> <span class="ml-3 font-semibold">Direct Bank Transfer (EFT)</span></label>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="sticky top-24">
                                <div class="bg-white p-6 rounded-lg shadow-md">
                                     <h2 class="text-2xl font-semibold mb-4 border-b pb-4">Your Order</h2>
                                     <div class="max-h-60 overflow-y-auto mb-4">${orderSummaryHTML}</div>
                                     <div class="space-y-2 border-t pt-4">
                                        <div class="flex justify-between"><span>Subtotal</span> <span>R ${subtotal.toFixed(2)}</span></div>
                                        <div class="flex justify-between"><span>VAT (15%)</span> <span>R ${vat.toFixed(2)}</span></div>
                                        <div class="flex justify-between font-bold text-lg pt-2 border-t mt-2"><span>Total</span> <span>R ${total.toFixed(2)}</span></div>
                                    </div>
                                     <button type="submit" form="checkout-form" class="w-full mt-6 bg-accent text-white py-3 rounded-lg font-semibold text-lg hover:bg-opacity-90">Place Order</button>
                                </div>
                            </div>
                         </div>
                    </div>
                `;
            }

            function generateLoginPage(params) {
                const fromCheckout = params && params.from === 'checkout';
                return `
                    <div class="container mx-auto px-6 py-16 max-w-lg">
                        ${fromCheckout ? '<div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-8" role="alert"><p>Please log in or register to complete your purchase.</p></div>' : ''}
                        <div class="grid grid-cols-2 text-center border-b">
                             <button id="show-login-form" class="font-semibold py-4 border-b-2 border-accent text-accent">Login</button>
                             <button id="show-register-form" class="font-semibold py-4 border-b-2 border-transparent text-secondary hover:text-primary">Register</button>
                        </div>

                        <div id="auth-forms-container" class="bg-white p-8 rounded-b-lg shadow-md">
                            <!-- Login Form -->
                            <form id="login-form">
                                <div class="space-y-4">
                                    <div><label class="form-label">Email</label><input type="email" id="login-email" class="form-input" required></div>
                                    <div><label class="form-label">Password</label><input type="password" id="login-password" class="form-input" required></div>
                                    <button type="submit" class="w-full bg-accent text-white py-3 rounded-lg font-semibold">Login</button>
                                    <p id="login-error" class="text-red-500 text-sm mt-2"></p>
                                </div>
                            </form>
                            <!-- Register Form -->
                            <form id="register-form" class="hidden">
                                 <div class="space-y-4">
                                    <div><label class="form-label">Email</label><input type="email" id="register-email" class="form-input" required></div>
                                    <div><label class="form-label">Password</label><input type="password" id="register-password" class="form-input" required></div>
                                    <button type="submit" class="w-full bg-accent text-white py-3 rounded-lg font-semibold">Create Account</button>
                                     <p id="register-error" class="text-red-500 text-sm mt-2"></p>
                                </div>
                            </form>
                        </div>
                    </div>
                `;
            }

            function generateAccountPage() { 
                return `
                    <div class="container mx-auto px-6 py-12">
                        <h1 class="text-4xl font-bold mb-8">My Account</h1>
                        <div class="flex flex-col md:flex-row gap-8 items-start">
                            <aside class="w-full md:w-1/4">
                                <div class="bg-white p-4 rounded-lg shadow-md">
                                    <nav class="space-y-1">
                                        <a href="#" class="flex items-center px-4 py-2 text-sm font-medium rounded-md bg-gray-100 text-accent"><i data-lucide="layout-dashboard" class="mr-3 h-5 w-5"></i> Dashboard</a>
                                        <a href="#" class="flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-600 hover:bg-gray-50"><i data-lucide="package" class="mr-3 h-5 w-5"></i> Orders</a>
                                        <a href="#" class="flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-600 hover:bg-gray-50"><i data-lucide="map-pin" class="mr-3 h-5 w-5"></i> Addresses</a>
                                        <a href="#" class="flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-600 hover:bg-gray-50"><i data-lucide="user" class="mr-3 h-5 w-5"></i> Account Details</a>
                                        <button id="logout-button" class="w-full flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-600 hover:bg-gray-50"><i data-lucide="log-out" class="mr-3 h-5 w-5"></i> Logout</button>
                                    </nav>
                                </div>
                            </aside>
                            <div class="w-full md:w-3/4 bg-white p-8 rounded-lg shadow-md">
                                <h2 class="text-2xl font-bold mb-2">Dashboard</h2>
                                <p class="text-secondary text-sm mb-6">Welcome back, ${currentUser?.email || 'User'}</p>
                                <p class="text-secondary">From your account dashboard you can view your recent orders, manage your shipping addresses, and edit your password and account details.</p>
                                <h3 class="text-xl font-bold mt-8 mb-4">Recent Orders</h3>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm text-left">
                                        <thead class="bg-gray-50"><tr><th class="p-3">Order</th><th class="p-3">Date</th><th class="p-3">Status</th><th class="p-3">Total</th></tr></thead>
                                        <tbody>
                                            <tr class="border-b">
                                                <td class="p-3 font-medium text-accent">#12345</td><td class="p-3">Sep 5, 2024</td><td class="p-3">Processing</td><td class="p-3">R 4,500.00</td>
                                            </tr>
                                             <tr class="border-b">
                                                <td class="p-3 font-medium text-accent">#12344</td><td class="p-3">Aug 28, 2024</td><td class="p-3">Completed</td><td class="p-3">R 1,250.50</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                `; 
            }
            
            function generateOrderConfirmationPage() {
                return `
                     <div class="text-center container mx-auto px-6 py-24">
                        <i data-lucide="check-circle-2" class="w-24 h-24 mx-auto text-green-500"></i>
                        <h1 class="text-4xl font-bold mt-6 mb-2">Thank You For Your Order!</h1>
                        <p class="text-secondary mb-8">Your order has been placed successfully. A confirmation email has been sent to you.</p>
                        <a href="#" class="main-nav-link bg-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-opacity-90" data-page="home">
                            Continue Shopping
                        </a>
                    </div>
                `;
            }

            function generateFaqPage() { 
                const faqs = [
                    { q: 'How do I place an order?', a: 'Simply browse our products, add items to your cart, and proceed to checkout. You will be required to create an account or log in to complete the purchase. You can also contact our sales team for bulk orders and quotes.' },
                    { q: 'What are your shipping options?', a: 'We offer standard and express shipping nationwide. Delivery times and costs vary based on your location and the size of the order. Final shipping costs are calculated at checkout.' },
                    { q: 'Can I apply for financing?', a: 'Yes, we offer an instant financing application directly on our website for qualifying businesses. Navigate to the "Apply for Finance" page to get started. Please note this is separate from your e-commerce account.' },
                    { q: 'What is your return policy?', a: 'We accept returns on most unopened items within 30 days of purchase. Please see our full return policy for details and exceptions. To initiate a return, please visit your account dashboard.' },
                    { q: 'How does my shopping cart get saved?', a: 'When you are logged into your account, your shopping cart is automatically saved. This allows you to continue shopping on different devices or at a later time without losing your items.'}
                ];

                let faqHTML = '<div class="space-y-4">';
                faqs.forEach(faq => {
                    faqHTML += `
                        <div class="border rounded-lg bg-white">
                            <button class="faq-question w-full flex justify-between items-center text-left p-4 font-semibold">
                                <span>${faq.q}</span>
                                <i data-lucide="chevron-down" class="transition-transform duration-300"></i>
                            </button>
                            <div class="faq-answer px-4 text-secondary">
                                <p>${faq.a}</p>
                            </div>
                        </div>
                    `;
                });
                faqHTML += '</div>';

                return `
                    <div class="container mx-auto px-6 py-12">
                        <h1 class="text-4xl font-bold text-center mb-12">Frequently Asked Questions</h1>
                        <div class="max-w-3xl mx-auto">${faqHTML}</div>
                    </div>
                `;
            }
            

            // ========================================================== //
            //                      CART LOGIC (with Firestore)          //
            // ========================================================== //
            
            async function saveCartToFirestore() {
                if (currentUser) {
                    try {
                        const cartRef = doc(db, `/artifacts/${appId}/users/${currentUser.uid}/cart/current`);
                        await setDoc(cartRef, { items: shoppingCart });
                    } catch (error) {
                        console.error("Error saving cart to Firestore:", error);
                    }
                }
            }
            
            async function mergeAndLoadCart(localCart) {
                if (!currentUser) return;
                try {
                    const cartRef = doc(db, `/artifacts/${appId}/users/${currentUser.uid}/cart/current`);
                    const cartSnap = await getDoc(cartRef);
                    let firestoreCart = [];
                    if (cartSnap.exists()) {
                        firestoreCart = cartSnap.data().items || [];
                    }

                    // Merge local (anonymous) cart into Firestore cart
                    if (localCart.length > 0) {
                        localCart.forEach(localItem => {
                            const existingItem = firestoreCart.find(fsItem => fsItem.id === localItem.id);
                            if (existingItem) {
                                existingItem.quantity += localItem.quantity;
                            } else {
                                firestoreCart.push(localItem);
                            }
                        });
                    }
                    
                    shoppingCart = firestoreCart;
                    await saveCartToFirestore(); // Save the merged cart back
                    updateCartUI();

                } catch (error) {
                    console.error("Error merging/loading cart:", error);
                    shoppingCart = localCart; // Fallback to local cart if firestore fails
                }
                updateCartUI();
            }

            async function addToCart(productId, quantity = 1) {
                const existingItem = shoppingCart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    shoppingCart.push({ id: productId, quantity: quantity });
                }
                if (currentUser) {
                    await saveCartToFirestore();
                }
                updateCartUI();
                showNotification(`${productDatabase.find(p=>p.id === productId).name} added to cart!`);
            }

            async function removeFromCart(productId) {
                shoppingCart = shoppingCart.filter(item => item.id !== productId);
                if (currentUser) {
                    await saveCartToFirestore();
                }
                updateCartUI();
                showPage('cart'); // Re-render the cart page
            }
            
            async function updateCartQuantity(productId, quantity) {
                const itemInCart = shoppingCart.find(item => item.id === productId);
                if (itemInCart) {
                    if (quantity > 0) {
                        itemInCart.quantity = parseInt(quantity, 10);
                    } else {
                        shoppingCart = shoppingCart.filter(item => item.id !== productId);
                    }
                }
                if (currentUser) {
                    await saveCartToFirestore();
                }
                updateCartUI();
                showPage('cart'); // Re-render the cart page
            }

            function updateCartUI() {
                const cartCount = shoppingCart.reduce((total, item) => total + item.quantity, 0);
                document.getElementById('cart-item-count').textContent = cartCount;
            }

            function showNotification(message, isError = false) {
                // Remove any existing notification
                const existingNotif = document.querySelector('.notification-popup');
                if (existingNotif) existingNotif.remove();

                const notif = document.createElement('div');
                notif.className = `notification-popup fixed top-24 right-5 text-white px-6 py-3 rounded-lg shadow-lg z-[100] transform translate-x-full transition-transform duration-300 ease-in-out ${isError ? 'bg-red-500' : 'bg-primary'}`;
                const icon = isError ? 'x-circle' : 'check-circle';
                const iconColor = isError ? 'text-white' : 'text-green-400';
                notif.innerHTML = `<div class="flex items-center"><i data-lucide="${icon}" class="mr-2 ${iconColor}"></i><span>${message}</span></div>`;
                document.body.appendChild(notif);
                lucide.createIcons();

                setTimeout(() => {
                    notif.classList.remove('translate-x-full');
                }, 100);

                setTimeout(() => {
                    notif.classList.add('translate-x-full');
                    setTimeout(() => notif.remove(), 300);
                }, 3000);
            }


            // ========================================================== //
            //                  DYNAMIC CONTENT & INIT                    //
            // ========================================================== //

            function renderFeaturedProducts() {
                const featuredWrapper = document.getElementById('featured-products-wrapper');
                if (!featuredWrapper) return;
                let featuredHTML = '';
                // Get products with highest review counts
                const sortedByPopularity = [...productDatabase].sort((a,b) => b.reviews - a.reviews);
                sortedByPopularity.slice(0, 10).forEach(product => { 
                    featuredHTML += `<div class="swiper-slide h-auto !flex flex-col">${generateProductCard(product)}</div>`;
                });
                featuredWrapper.innerHTML = featuredHTML;
            }

            function initProductDetailTabs() {
                const tabButtons = document.querySelectorAll('.product-tab-btn');
                const tabContents = document.querySelectorAll('.product-tab-content');

                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const tab = button.dataset.tab;

                        tabButtons.forEach(btn => {
                            btn.classList.remove('border-accent', 'text-accent');
                            btn.classList.add('border-transparent', 'text-secondary');
                        });

                        button.classList.add('border-accent', 'text-accent');
                        button.classList.remove('border-transparent', 'text-secondary');

                        tabContents.forEach(content => {
                            if (content.id === `tab-content-${tab}`) {
                                content.classList.remove('hidden');
                            } else {
                                content.classList.add('hidden');
                            }
                        });
                    });
                });
            }
            
            function initFaqAccordion() {
                const questions = document.querySelectorAll('.faq-question');
                questions.forEach(q => {
                    q.addEventListener('click', () => {
                        const currentlyActive = document.querySelector('.faq-question.active');
                        if (currentlyActive && currentlyActive !== q) {
                            currentlyActive.classList.remove('active');
                            currentlyActive.querySelector('i').classList.remove('rotate-180');
                        }
                        q.classList.toggle('active');
                        q.querySelector('i').classList.toggle('rotate-180');
                    });
                });
            }
            
            function initAuthForms(params){
                const loginForm = document.getElementById('login-form');
                const registerForm = document.getElementById('register-form');
                const showLoginBtn = document.getElementById('show-login-form');
                const showRegisterBtn = document.getElementById('show-register-form');

                showLoginBtn.addEventListener('click', () => {
                    loginForm.classList.remove('hidden');
                    registerForm.classList.add('hidden');
                    showLoginBtn.classList.add('border-accent', 'text-accent');
                    showRegisterBtn.classList.remove('border-accent', 'text-accent');
                });

                 showRegisterBtn.addEventListener('click', () => {
                    registerForm.classList.remove('hidden');
                    loginForm.classList.add('hidden');
                    showRegisterBtn.classList.add('border-accent', 'text-accent');
                    showLoginBtn.classList.remove('border-accent', 'text-accent');
                });
                
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('login-email').value;
                    const password = document.getElementById('login-password').value;
                    const errorEl = document.getElementById('login-error');
                    errorEl.textContent = '';
                    try {
                        await signInWithEmailAndPassword(auth, email, password);
                        showNotification('Welcome back!');
                        if(params && params.from === 'checkout') {
                            showPage('checkout');
                        } else {
                            showPage('account');
                        }
                    } catch (error) {
                        errorEl.textContent = error.message;
                        showNotification('Login failed. Please check your credentials.', true);
                    }
                });

                registerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('register-email').value;
                    const password = document.getElementById('register-password').value;
                    const errorEl = document.getElementById('register-error');
                    errorEl.textContent = '';
                    try {
                        await createUserWithEmailAndPassword(auth, email, password);
                        showNotification('Welcome! Your account has been created.');
                         if(params && params.from === 'checkout') {
                            showPage('checkout');
                        } else {
                            showPage('account');
                        }
                    } catch (error) {
                        errorEl.textContent = error.message;
                        showNotification('Registration failed.', true);
                    }
                });
            }
            
            function initAccountPage(){
                const logoutButton = document.getElementById('logout-button');
                logoutButton.addEventListener('click', async () => {
                    try {
                        await signOut(auth);
                        showNotification('You have been logged out.');
                        showPage('home');
                    } catch(error){
                        console.error('Logout failed:', error);
                        showNotification('Logout failed.', true);
                    }
                });
            }

            function initCheckoutForm(){
                const checkoutForm = document.getElementById('checkout-form');
                checkoutForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    // Simulate payment processing
                    const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
                    let message = `Processing payment...`;
                    if(paymentMethod === 'netcash'){
                        message = 'Redirecting to Netcash for secure payment...';
                    }
                    
                    pageContainer.innerHTML = `<div class="text-center py-40">
                        <h2 class="text-2xl font-semibold">${message}</h2>
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-accent mx-auto mt-6"></div>
                    </div>`;

                    setTimeout(async () => {
                        // Clear the cart after "successful" payment
                        shoppingCart = [];
                        await saveCartToFirestore();
                        updateCartUI();
                        showPage('order-confirmation');
                    }, 2500);
                });
            }
            
            function initProductFilters() {
                const checkboxes = document.querySelectorAll('.filter-checkbox');
                const radios = document.querySelectorAll('.filter-radio');
                const sortSelect = document.getElementById('sort-select');
                const clearFiltersBtn = document.getElementById('clear-filters-btn');
                
                const priceSlider = document.getElementById('price-slider');
                noUiSlider.create(priceSlider, {
                    start: [0, 6000],
                    connect: true,
                    range: { 'min': 0, 'max': 6000 },
                    step: 100,
                    format: { to: value => Math.round(value), from: value => Number(value) }
                });

                priceSlider.noUiSlider.on('update', function (values, handle) {
                    document.getElementById('price-lower').innerHTML = `R ${values[0]}`;
                    document.getElementById('price-upper').innerHTML = `R ${values[1]}`;
                });
                 priceSlider.noUiSlider.on('change', () => { currentPage = 1; applyFilters(); });

                checkboxes.forEach(cb => cb.addEventListener('change', () => { currentPage = 1; applyFilters(); }));
                radios.forEach(rb => rb.addEventListener('change', () => { currentPage = 1; applyFilters(); }));
                sortSelect.addEventListener('change', () => { currentPage = 1; applyFilters(); });
                clearFiltersBtn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-checkbox:checked, .filter-radio:checked').forEach(el => el.checked = false);
                    priceSlider.noUiSlider.set([0, 6000]);
                    sortSelect.value = 'popularity';
                    currentPage = 1;
                    applyFilters();
                });

                applyFilters(); // Initial render
            }
            
            let currentPage = 1;
            const productsPerPage = 12;
            let currentFilteredProducts = [];

            function applyFilters() {
                const selectedCategories = Array.from(document.querySelectorAll('[data-filter="category"]:checked')).map(el => el.value);
                const selectedBrands = Array.from(document.querySelectorAll('[data-filter="brand"]:checked')).map(el => el.value);
                const selectedRating = document.querySelector('[data-filter="rating"]:checked')?.value || 0;
                const priceRange = document.getElementById('price-slider').noUiSlider.get();
                const sortValue = document.getElementById('sort-select').value;
                
                let filteredProducts = productDatabase.filter(p => {
                    const categoryMatch = selectedCategories.length === 0 || selectedCategories.includes(p.category);
                    const brandMatch = selectedBrands.length === 0 || selectedBrands.includes(p.brand);
                    const ratingMatch = p.rating >= selectedRating;
                    const priceMatch = p.price >= priceRange[0] && p.price <= priceRange[1];
                    return categoryMatch && brandMatch && ratingMatch && priceMatch;
                });

                // Sorting
                switch(sortValue) {
                    case 'price-asc': filteredProducts.sort((a,b) => a.price - b.price); break;
                    case 'price-desc': filteredProducts.sort((a,b) => b.price - a.price); break;
                    case 'rating-desc': filteredProducts.sort((a,b) => b.rating - a.rating); break;
                    case 'popularity':
                    default: filteredProducts.sort((a,b) => b.reviews - a.reviews); break;
                }

                document.getElementById('product-count').textContent = `Showing ${filteredProducts.length} products`;
                currentFilteredProducts = filteredProducts;
                renderProductGrid();
            }

            function renderProductGrid() {
                const productGrid = document.getElementById('product-grid');
                productGrid.innerHTML = '';
                
                const paginatedProducts = currentFilteredProducts.slice((currentPage - 1) * productsPerPage, currentPage * productsPerPage);

                if (paginatedProducts.length === 0) {
                    productGrid.innerHTML = `<p class="col-span-full text-center text-secondary">No products match your filters.</p>`;
                } else {
                    paginatedProducts.forEach(product => {
                        productGrid.innerHTML += generateProductCard(product);
                    });
                }
                
                renderPagination(currentFilteredProducts.length);
                attachEventListeners(); // Re-attach because we cleared the grid
                lucide.createIcons();
            }

            function renderPagination(totalProducts) {
                const paginationContainer = document.getElementById('pagination-container');
                paginationContainer.innerHTML = '';
                const totalPages = Math.ceil(totalProducts / productsPerPage);

                if (totalPages <= 1) return;

                let paginationHTML = '<nav class="flex items-center space-x-2">';
                for (let i = 1; i <= totalPages; i++) {
                    paginationHTML += `<button data-page-num="${i}" class="pagination-btn px-4 py-2 rounded-md text-sm font-medium ${i === currentPage ? 'bg-accent text-white' : 'bg-white text-secondary hover:bg-gray-100'}">${i}</button>`;
                }
                paginationHTML += '</nav>';
                paginationContainer.innerHTML = paginationHTML;

                document.querySelectorAll('.pagination-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        currentPage = parseInt(e.target.dataset.pageNum);
                        renderProductGrid(); 
                        window.scrollTo(0, document.getElementById('product-grid').offsetTop - 100);
                    });
                });
            }


            // ========================================================== //
            //                      SWIPER INIT                           //
            // ========================================================== //

            function initSwipers() {
                new Swiper('.featured-products-slider', {
                    loop: true, slidesPerView: 1, spaceBetween: 20,
                    navigation: { nextEl: '.featured-next', prevEl: '.featured-prev' },
                    pagination: { el: '.swiper-pagination', clickable: true },
                    breakpoints: { 640: { slidesPerView: 2 }, 768: { slidesPerView: 3 }, 1024: { slidesPerView: 4 } },
                });

                new Swiper('.brands-slider', {
                    loop: true, slidesPerView: 2, spaceBetween: 30,
                    autoplay: { delay: 2500, disableOnInteraction: false },
                    breakpoints: { 640: { slidesPerView: 3 }, 768: { slidesPerView: 4 }, 1024: { slidesPerView: 5 } },
                });
            }

        });
    </script>
</body>
</html>

